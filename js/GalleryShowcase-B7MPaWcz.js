import{j as i,P as r}from"./index-8mUkeaU9.js";import{b as u,e as A}from"./vendor-ASO3vaGF.js";function G({categories:l,activeCategory:a,onCategoryChange:e}){const[t,n]=u.useState(0),o=u.useRef(null),s=u.useRef([]);u.useEffect(()=>{const p=l.findIndex(m=>m.id===a);p!==-1&&n(p)},[a,l]),u.useEffect(()=>{if(s.current[t]&&o.current){const p=s.current[t],m=o.current;if(m.scrollWidth>m.clientWidth){const c=p.offsetLeft,f=p.offsetWidth,y=m.clientWidth,v=c-y/2+f/2;m.scrollTo({left:v,behavior:"smooth"})}}},[t]);const d=(p,m)=>{n(m),e(p.id)};return i.jsx("div",{className:"category-toggle",children:i.jsx("div",{className:"category-toggle-container",ref:o,children:l.map((p,m)=>i.jsxs("button",{ref:c=>s.current[m]=c,className:`category-button ${m===t?"active":""}`,onClick:()=>d(p,m),"aria-label":`Visa ${p.name} (${p.images.length} bilder)`,children:[i.jsx("span",{className:"category-name",children:p.name}),i.jsxs("span",{className:"category-count",children:["(",p.images.length,")"]})]},p.id))})})}G.propTypes={categories:r.arrayOf(r.shape({id:r.string.isRequired,name:r.string.isRequired,images:r.array.isRequired})).isRequired,activeCategory:r.string.isRequired,onCategoryChange:r.func.isRequired};const U=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"lokal",subcategory:"upper",number:1,displayName:"Lokal - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"lokal",subcategory:"upper",number:2,displayName:"Lokal - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"lokal",subcategory:"upper",number:3,displayName:"Lokal - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"lokal",subcategory:"upper",number:4,displayName:"Lokal - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"lokal",subcategory:"upper",number:5,displayName:"Lokal - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"lokal",subcategory:"under",number:1,displayName:"Lokal - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"lokal",subcategory:"under",number:2,displayName:"Lokal - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"lokal",subcategory:"under",number:3,displayName:"Lokal - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"lokal",subcategory:"under",number:4,displayName:"Lokal - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"lokal",subcategory:"under",number:5,displayName:"Lokal - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"lokal",subcategory:"under",number:6,displayName:"Lokal - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"lokal",subcategory:"under",number:7,displayName:"Lokal - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"lokal",subcategory:"under",number:8,displayName:"Lokal - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"lokal",subcategory:"under",number:9,displayName:"Lokal - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"lokal",subcategory:"under",number:10,displayName:"Lokal - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"lokal",subcategory:"under",number:11,displayName:"Lokal - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"lokal",subcategory:"kok",number:1,displayName:"Lokal - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"lokal",subcategory:"kok",number:2,displayName:"Lokal - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"lokal",subcategory:"kok",number:3,displayName:"Lokal - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"lokal",subcategory:"kok",number:4,displayName:"Lokal - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"lokal",subcategory:"service",number:1,displayName:"Lokal - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"lokal",subcategory:"service",number:2,displayName:"Lokal - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"lokal",subcategory:"service",number:3,displayName:"Lokal - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"lokal",subcategory:"ute",number:1,displayName:"Lokal - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"lokal",subcategory:"ute-toa",number:1,displayName:"Lokal - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"lokal",subcategory:"ute-toa",number:2,displayName:"Lokal - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]},{id:"lokal",name:"Lokal",description:"Lokalen på Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"lokal",subcategory:"upper",number:1,displayName:"Lokal - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"lokal",subcategory:"upper",number:2,displayName:"Lokal - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"lokal",subcategory:"upper",number:3,displayName:"Lokal - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"lokal",subcategory:"upper",number:4,displayName:"Lokal - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"lokal",subcategory:"upper",number:5,displayName:"Lokal - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"lokal",subcategory:"under",number:1,displayName:"Lokal - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"lokal",subcategory:"under",number:2,displayName:"Lokal - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"lokal",subcategory:"under",number:3,displayName:"Lokal - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"lokal",subcategory:"under",number:4,displayName:"Lokal - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"lokal",subcategory:"under",number:5,displayName:"Lokal - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"lokal",subcategory:"under",number:6,displayName:"Lokal - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"lokal",subcategory:"under",number:7,displayName:"Lokal - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"lokal",subcategory:"under",number:8,displayName:"Lokal - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"lokal",subcategory:"under",number:9,displayName:"Lokal - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"lokal",subcategory:"under",number:10,displayName:"Lokal - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"lokal",subcategory:"under",number:11,displayName:"Lokal - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"lokal",subcategory:"kok",number:1,displayName:"Lokal - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"lokal",subcategory:"kok",number:2,displayName:"Lokal - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"lokal",subcategory:"kok",number:3,displayName:"Lokal - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"lokal",subcategory:"kok",number:4,displayName:"Lokal - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"lokal",subcategory:"service",number:1,displayName:"Lokal - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"lokal",subcategory:"service",number:2,displayName:"Lokal - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"lokal",subcategory:"service",number:3,displayName:"Lokal - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"lokal",subcategory:"ute",number:1,displayName:"Lokal - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"lokal",subcategory:"ute-toa",number:1,displayName:"Lokal - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"lokal",subcategory:"ute-toa",number:2,displayName:"Lokal - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]}],F={categories:U};function Y(l,a){if(l==null)return{};var e=V(l,a),t,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(l);for(n=0;n<o.length;n++)t=o[n],!(a.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(l,t)&&(e[t]=l[t])}return e}function V(l,a){if(l==null)return{};var e={},t=Object.keys(l),n,o;for(o=0;o<t.length;o++)n=t[o],!(a.indexOf(n)>=0)&&(e[n]=l[n]);return e}function S(){return S=Object.assign||function(l){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(l[t]=e[t])}return l},S.apply(this,arguments)}function H(l,a){var e=Object.keys(l);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(l);a&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(l,n).enumerable})),e.push.apply(e,t)}return e}function O(l){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?H(Object(e),!0).forEach(function(t){X(l,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(e)):H(Object(e)).forEach(function(t){Object.defineProperty(l,t,Object.getOwnPropertyDescriptor(e,t))})}return l}function X(l,a,e){return a in l?Object.defineProperty(l,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):l[a]=e,l}const J={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},D=2;class T extends A.Component{constructor(a){super(a),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||D,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const a=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||D});let t=1/0,n=e.default||D;for(let o in e){const s=parseInt(o);s>0&&a<=s&&s<t&&(t=s,n=e[o])}n=Math.max(1,parseInt(n)||1),this.state.columnCount!==n&&this.setState({columnCount:n})}itemsInColumns(){const a=this.state.columnCount,e=new Array(a),t=A.Children.toArray(this.props.children);for(let n=0;n<t.length;n++){const o=n%a;e[o]||(e[o]=[]),e[o].push(t[n])}return e}renderColumns(){const{column:a,columnAttrs:e={},columnClassName:t}=this.props,n=this.itemsInColumns(),o=`${100/n.length}%`;let s=t;s&&typeof s!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof s=="undefined"&&(s="my-masonry-grid_column"));const d=O(O(O({},a),e),{},{style:O(O({},e.style),{},{width:o}),className:s});return n.map((p,m)=>A.createElement("div",S({},d,{key:m}),p))}logDeprecated(a){console.error("[Masonry]",a)}render(){const a=this.props,{children:e,breakpointCols:t,columnClassName:n,columnAttrs:o,column:s,className:d}=a,p=Y(a,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let m=d;return typeof d!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof d=="undefined"&&(m="my-masonry-grid")),A.createElement("div",S({},p,{className:m}),this.renderColumns())}}T.defaultProps=J;const W={default:3,768:2};function $({images:l,isLoading:a,onImageSelect:e,categoryName:t}){return a?i.jsx(T,{breakpointCols:W,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((n,o)=>i.jsx("div",{className:"gallery-thumbnail skeleton-item",children:i.jsx("div",{className:"skeleton-image",style:{height:`${200+o%3*50}px`}})},o))}):i.jsx(T,{breakpointCols:W,className:"gallery-grid",columnClassName:"gallery-column",children:l.slice(0,6).map((n,o)=>i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>e(o),role:"button",tabIndex:0,"aria-label":`Öppna bild ${o+1} av ${l.length} i lightbox`,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e(o))},children:[i.jsx("img",{src:n.thumbnail,alt:n.thumbnailAlt,loading:"eager"}),i.jsx("div",{className:"image-overlay",children:i.jsx("span",{className:"image-category",children:t!=null?t:"Alla"})})]},o))})}$.propTypes={images:r.arrayOf(r.shape({thumbnail:r.string,thumbnailAlt:r.string})).isRequired,isLoading:r.bool.isRequired,onImageSelect:r.func.isRequired,categoryName:r.string};$.defaultProps={categoryName:"Alla"};const Q={default:3,768:2};function B({images:l,startIndex:a,totalCount:e,onImageSelect:t,categoryName:n,buttonMode:o,onToggle:s,containerRef:d,buttonRef:p}){return i.jsxs("div",{className:"expanded-gallery-container",ref:d,children:[i.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),i.jsx(T,{breakpointCols:Q,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:l.map((m,c)=>{const f=c+a;return i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>t(f),role:"button",tabIndex:0,"aria-label":`Öppna bild ${f+1} av ${e} i lightbox`,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),t(f))},children:[i.jsx("img",{src:m.thumbnail,alt:m.thumbnailAlt,loading:"lazy"}),i.jsx("div",{className:"image-overlay",children:i.jsx("span",{className:"image-category",children:n!=null?n:"Alla"})})]},f)})}),i.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),i.jsx("button",{ref:p,className:`hide-images-button ${o==="fixed"?"is-fixed":""} ${o==="bottom"?"at-bottom":""} ${o==="hidden"?"is-hidden":""}`,onClick:s,"aria-label":"Dölj utökade galleri bilder","aria-hidden":o==="hidden",children:"Dölj bilder"})]})}B.propTypes={images:r.arrayOf(r.shape({thumbnail:r.string,thumbnailAlt:r.string})).isRequired,startIndex:r.number,totalCount:r.number,onImageSelect:r.func.isRequired,categoryName:r.string,buttonMode:r.string.isRequired,onToggle:r.func.isRequired,containerRef:r.shape({current:r.any}),buttonRef:r.shape({current:r.any})};B.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function K({isOpen:l,images:a,currentIndex:e,currentImage:t,onClose:n,onNext:o,onPrevious:s,onSelectImage:d,dialogRef:p,closeButtonRef:m}){return l?i.jsx("div",{className:"gallery-model",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",ref:p,onMouseDown:c=>{c.target===c.currentTarget&&n()},children:i.jsxs("div",{className:"gallery-model-content",children:[i.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",a.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),i.jsx("button",{className:"gallery-close-button",onClick:n,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",ref:m,type:"button",children:"×"}),t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"lightbox-stage",children:[a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--prev",onClick:s,"aria-label":"Visa föregående bild",children:"‹"}),i.jsx("figure",{className:"lightbox-image-wrapper",children:i.jsx("img",{src:t.original,alt:t.originalAlt||t.description||"Bild i galleriet",loading:"eager"})}),a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--next",onClick:o,"aria-label":"Visa nästa bild",children:"›"})]}),i.jsxs("div",{className:"lightbox-footer",children:[i.jsxs("span",{className:"lightbox-counter","aria-live":"polite",children:[e+1," / ",a.length]}),a.length>1&&i.jsx("div",{className:"lightbox-thumbnails",role:"list",children:a.map((c,f)=>{var v;const y=f===e;return i.jsx("button",{type:"button",className:`lightbox-thumbnail ${y?"is-active":""}`,onClick:()=>d(f),"aria-label":`Gå till bild ${f+1} av ${a.length}`,"aria-current":y?"true":void 0,children:i.jsx("img",{src:c.thumbnail,alt:c.thumbnailAlt,loading:"lazy"})},(v=c.filename)!=null?v:f)})})]})]}):i.jsx("div",{className:"lightbox-empty",children:i.jsx("p",{children:"Inga bilder tillgängliga i denna kategori."})})]})}):null}K.propTypes={isOpen:r.bool.isRequired,images:r.arrayOf(r.shape({original:r.string,originalAlt:r.string,description:r.string,thumbnail:r.string,thumbnailAlt:r.string,filename:r.string})).isRequired,currentIndex:r.number.isRequired,currentImage:r.shape({original:r.string,originalAlt:r.string,description:r.string}),onClose:r.func.isRequired,onNext:r.func.isRequired,onPrevious:r.func.isRequired,onSelectImage:r.func.isRequired,dialogRef:r.shape({current:r.any}).isRequired,closeButtonRef:r.shape({current:r.any}).isRequired};K.defaultProps={currentImage:null};const Z=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),P=(l,a)=>{if(a===0)return 0;const e=l%a;return e<0?e+a:e};function ee(l,a){const[e,t]=u.useState(!1),[n,o]=u.useState(0),s=u.useRef(null),d=u.useRef(null),p=u.useRef(null),m=u.useRef(new Set),c=l.length>0,f=u.useCallback(g=>{c&&(p.current=document.activeElement,o(P(g,l.length)),t(!0))},[c,l.length]),y=u.useCallback(()=>{t(!1)},[]),v=u.useCallback(g=>{c&&o(P(g,l.length))},[c,l.length]),j=u.useCallback(()=>{c&&o(g=>(g+1)%l.length)},[c,l.length]),L=u.useCallback(()=>{c&&o(g=>(g-1+l.length)%l.length)},[c,l.length]);u.useEffect(()=>{if(!c){o(0);return}o(g=>g>=l.length?l.length-1:g<0?0:g)},[c,l.length]),u.useEffect(()=>{if(!e){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[e]),u.useEffect(()=>{if(e){const k=d.current;k&&k.focus({preventScroll:!0});return}const g=p.current;g&&typeof g.focus=="function"&&requestAnimationFrame(()=>{g.focus({preventScroll:!0}),p.current=null})},[e]),u.useEffect(()=>{if(!e)return;const g=k=>{k.key==="Escape"&&y()};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[e,y]),u.useEffect(()=>{if(!e||!c)return;const g=k=>{switch(k.key){case"ArrowRight":k.preventDefault(),j();break;case"ArrowLeft":k.preventDefault(),L();break;case"Home":k.preventDefault(),v(0);break;case"End":k.preventDefault(),v(l.length-1);break}};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[e,c,l.length,j,L,v]),u.useEffect(()=>{if(!e)return;const g=s.current;if(!g)return;const k=N=>{if(N.key!=="Tab")return;const h=Array.from(g.querySelectorAll(Z)).filter(q=>!q.hasAttribute("aria-hidden"));if(h.length===0){N.preventDefault();return}const w=h[0],C=h[h.length-1],b=N.shiftKey,I=document.activeElement;!b&&I===C?(N.preventDefault(),w.focus()):b&&I===w&&(N.preventDefault(),C.focus())};return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}},[e]);const R=u.useCallback(g=>{if(!c)return;const k=P(g,l.length),N=l[k];if(!(N!=null&&N.original)||m.current.has(N.original))return;const h=new Image;h.src=N.original,m.current.add(N.original)},[c,l]);u.useEffect(()=>{m.current.clear()},[a]),u.useEffect(()=>{!e||!c||(R(n),R(n+1),R(n-1))},[e,c,n,R]);const x=u.useMemo(()=>c?l[n]:null,[c,l,n]);return{isOpen:e,currentIndex:n,currentImage:x,openLightbox:f,closeLightbox:y,goToImage:v,goToNextImage:j,goToPreviousImage:L,dialogRef:s,closeButtonRef:d}}const E="hidden",_="fixed",M="bottom";function le(l){const[a,e]=u.useState(E),t=u.useRef(null),n=u.useRef(null),o=u.useRef(E),s=u.useCallback(d=>{o.current!==d&&(o.current=d,e(d))},[]);return u.useEffect(()=>{if(!l){s(E);return}const d=t.current;if(!d)return;let p=!1;const m=8,c=d.querySelector(".sentinel-top"),f=d.querySelector(".sentinel-bottom");let y=!1,v=!1,j,L;const R=h=>{let w=0,C=h;for(;C;)w+=C.offsetTop||0,C=C.offsetParent;return w},x=()=>{const h=t.current;if(!h)return;const w=R(h),C=h.offsetHeight,b=w+C,I=window.scrollY||window.pageYOffset,q=window.innerHeight||document.documentElement.clientHeight,z=I+q;if(z<w){s(E);return}if(I>=b){s(E);return}if(z>=b-m){s(M);return}s(_)},g=()=>{p||(p=!0,requestAnimationFrame(()=>{x(),p=!1}))},k=()=>{x()};return"IntersectionObserver"in window&&c&&f&&(L=new IntersectionObserver(h=>{if(h.forEach(w=>{w.target===c&&(y=w.isIntersecting),w.target===f&&(v=w.isIntersecting)}),!y&&!v){const w=R(d),C=w+d.offsetHeight,b=window.scrollY||window.pageYOffset;if(b+(window.innerHeight||document.documentElement.clientHeight)<w||b>=C){s(E);return}}v?s(M):y&&s(_)},{root:null,threshold:0}),L.observe(c),L.observe(f)),window.ResizeObserver&&(j=new ResizeObserver(()=>x()),j.observe(d)),d.querySelectorAll("img").forEach(h=>{h.complete||h.addEventListener("load",x,{once:!0})}),setTimeout(x,50),setTimeout(x,200),setTimeout(x,600),x(),window.addEventListener("scroll",g,{passive:!0}),window.addEventListener("resize",k),()=>{window.removeEventListener("scroll",g),window.removeEventListener("resize",k),j&&j.disconnect(),L&&L.disconnect()}},[l,s]),{mode:a,containerRef:t,buttonRef:n}}function ne(){const[l,a]=u.useState("alla"),[e,t]=u.useState(!1),[n,o]=u.useState(!1),s=u.useMemo(()=>F.categories.find(b=>b.id===l),[l]),d=u.useMemo(()=>s!=null&&s.images?s.images.map(b=>({original:b.path,thumbnail:b.path,description:b.displayName,originalAlt:b.displayName,thumbnailAlt:b.displayName,filename:b.filename,subcategory:b.subcategory})):[],[s]),{isOpen:p,currentIndex:m,currentImage:c,openLightbox:f,closeLightbox:y,goToImage:v,goToNextImage:j,goToPreviousImage:L,dialogRef:R,closeButtonRef:x}=ee(d,l),{mode:g,containerRef:k,buttonRef:N}=le(n),h=u.useCallback(()=>{o(b=>!b)},[]),w=u.useCallback(b=>{t(!0),a(b),o(!1),y(),setTimeout(()=>{t(!1)},300)},[y]),C=(s==null?void 0:s.name)||"Alla";return i.jsxs("div",{className:"storegarden-gallery",children:[i.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),i.jsx(G,{categories:F.categories,activeCategory:l,onCategoryChange:w}),i.jsx($,{images:d,isLoading:e,onImageSelect:f,categoryName:C}),!n&&i.jsxs("button",{className:"show-more-button",onClick:h,"aria-expanded":n,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${d.length} bilder i galleriet`,children:["Visa alla bilder (",d.length,")"]}),n&&i.jsx(B,{images:d.slice(6),startIndex:6,totalCount:d.length,onImageSelect:f,categoryName:C,buttonMode:g,onToggle:h,containerRef:k,buttonRef:N}),i.jsx(K,{isOpen:p,images:d,currentIndex:m,currentImage:c,onClose:y,onNext:j,onPrevious:L,onSelectImage:v,dialogRef:R,closeButtonRef:x})]})}export{ne as default};
