import{j as s,P as c,g as W,a as G,l as ae}from"./index-DfgkAbYa.js";import{b as a,h as z}from"./vendor-kgT0sz4b.js";function oe({categories:e,activeCategory:n,onCategoryChange:t}){const[r,o]=a.useState(0),l=a.useRef(null),i=a.useRef([]);a.useEffect(()=>{const u=e.findIndex(h=>h.id===n);u!==-1&&o(u)},[n,e]),a.useEffect(()=>{if(i.current[r]&&l.current){const u=i.current[r],h=l.current;if(h.scrollWidth>h.clientWidth){const f=u.offsetLeft,C=u.offsetWidth,x=h.clientWidth,w=f-x/2+C/2;h.scrollTo({left:w,behavior:"smooth"})}}},[r]);const d=(u,h)=>{o(h),t(u.id)};return s.jsx("div",{className:"category-toggle",children:s.jsx("div",{className:"category-toggle-container",ref:l,children:e.map((u,h)=>s.jsxs("button",{ref:f=>i.current[h]=f,className:`category-button ${h===r?"active":""}`,onClick:()=>d(u,h),"aria-label":`Visa ${u.name} (${u.images.length} bilder)`,children:[s.jsx("span",{className:"category-name",children:u.name}),s.jsxs("span",{className:"category-count",children:["(",u.images.length,")"]})]},u.id))})})}oe.propTypes={categories:c.arrayOf(c.shape({id:c.string.isRequired,name:c.string.isRequired,images:c.array.isRequired})).isRequired,activeCategory:c.string.isRequired,onCategoryChange:c.func.isRequired};function ce(e,n){if(e==null)return{};var t=ue(e,n),r,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)r=l[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}function ue(e,n){if(e==null)return{};var t={},r=Object.keys(e),o,l;for(l=0;l<r.length;l++)o=r[l],!(n.indexOf(o)>=0)&&(t[o]=e[o]);return t}function H(){return H=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},H.apply(this,arguments)}function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Z(Object(t),!0).forEach(function(r){de(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function de(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const fe={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},K=2;class B extends z.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let t;this.props.breakpointCols&&this.props.breakpointCols.default?t=this.props.breakpointCols.default:t=parseInt(this.props.breakpointCols)||K,this.state={columnCount:t}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let t=this.props.breakpointCols;typeof t!="object"&&(t={default:parseInt(t)||K});let r=1/0,o=t.default||K;for(let l in t){const i=parseInt(l);i>0&&n<=i&&i<r&&(r=i,o=t[l])}o=Math.max(1,parseInt(o)||1),this.state.columnCount!==o&&this.setState({columnCount:o})}itemsInColumns(){const n=this.state.columnCount,t=new Array(n),r=z.Children.toArray(this.props.children);for(let o=0;o<r.length;o++){const l=o%n;t[l]||(t[l]=[]),t[l].push(r[o])}return t}renderColumns(){const{column:n,columnAttrs:t={},columnClassName:r}=this.props,o=this.itemsInColumns(),l=`${100/o.length}%`;let i=r;i&&typeof i!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof i=="undefined"&&(i="my-masonry-grid_column"));const d=$($($({},n),t),{},{style:$($({},t.style),{},{width:l}),className:i});return o.map((u,h)=>z.createElement("div",H({},d,{key:h}),u))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:t,breakpointCols:r,columnClassName:o,columnAttrs:l,column:i,className:d}=n,u=ce(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let h=d;return typeof d!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof d=="undefined"&&(h="my-masonry-grid")),z.createElement("div",H({},u,{className:h}),this.renderColumns())}}B.defaultProps=fe;const ee={default:3,768:2};function V({images:e,isLoading:n,onImageSelect:t,categoryName:r}){return n?s.jsx(B,{breakpointCols:ee,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((o,l)=>s.jsx("div",{className:"gallery-thumbnail skeleton-item",children:s.jsx("div",{className:"skeleton-image",style:{height:`${200+l%3*50}px`}})},l))}):s.jsx(B,{breakpointCols:ee,className:"gallery-grid",columnClassName:"gallery-column",children:e.slice(0,6).map((o,l)=>s.jsx("div",{className:"gallery-thumbnail",onClick:()=>t(l),role:"button",tabIndex:0,"aria-label":`Öppna bild ${l+1} av ${e.length} i lightbox`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),t(l))},children:s.jsx("img",{src:o.thumbnail,alt:o.thumbnailAlt,loading:"eager"})},l))})}V.propTypes={images:c.arrayOf(c.shape({thumbnail:c.string,thumbnailAlt:c.string})).isRequired,isLoading:c.bool.isRequired,onImageSelect:c.func.isRequired,categoryName:c.string};V.defaultProps={categoryName:"Alla"};const me={default:3,768:2};function X({images:e,startIndex:n,totalCount:t,onImageSelect:r,categoryName:o,buttonMode:l,onToggle:i,containerRef:d,buttonRef:u}){return s.jsxs("div",{className:"expanded-gallery-container",ref:d,children:[s.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),s.jsx(B,{breakpointCols:me,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:e.map((h,f)=>{const C=f+n;return s.jsx("div",{className:"gallery-thumbnail",onClick:()=>r(C),role:"button",tabIndex:0,"aria-label":`Öppna bild ${C+1} av ${t} i lightbox`,onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),r(C))},children:s.jsx("img",{src:h.thumbnail,alt:h.thumbnailAlt,loading:"lazy"})},C)})}),s.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),s.jsx("button",{ref:u,className:`hide-images-button ${l==="fixed"?"is-fixed":""} ${l==="bottom"?"at-bottom":""} ${l==="hidden"?"is-hidden":""}`,onClick:i,"aria-label":"Dölj utökade galleri bilder","aria-hidden":l==="hidden",children:"Dölj bilder"})]})}X.propTypes={images:c.arrayOf(c.shape({thumbnail:c.string,thumbnailAlt:c.string})).isRequired,startIndex:c.number,totalCount:c.number,onImageSelect:c.func.isRequired,categoryName:c.string,buttonMode:c.string.isRequired,onToggle:c.func.isRequired,containerRef:c.shape({current:c.any}),buttonRef:c.shape({current:c.any})};X.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function U({isOpen:e,images:n,currentIndex:t,currentImage:r,onClose:o,onNext:l,onPrevious:i,onSelectImage:d,dialogRef:u,closeButtonRef:h,categories:f,activeCategory:C,onCategoryChange:x}){const[w,E]=a.useState(!1),[R,S]=a.useState(null),[I,g]=a.useState(null),p=a.useRef(null),v=a.useRef(null),b=50;a.useEffect(()=>{p.current&&(typeof u=="function"?u(p.current):u&&(u.current=p.current))},[u]),a.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),a.useEffect(()=>{if(!e)return;const m=k=>{switch(k.key){case"ArrowRight":l();break;case"ArrowLeft":i();break;case"Escape":o();break;case" ":k.preventDefault(),E(T=>!T);break}};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[e,l,i,o]);const y=m=>{g(null),S(m.targetTouches[0].clientX)},N=m=>{g(m.targetTouches[0].clientX)},O=()=>{if(!R||!I)return;const m=R-I,k=m>b,T=m<-b;k&&n.length>1?l():T&&n.length>1&&i()},A=m=>{m.stopPropagation(),E(k=>!k)};if(!e||!n||!r)return null;const D=t+1,P=n.length;return s.jsx("div",{className:`gallery-model ${w?"is-immersive":""}`,role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading",ref:p,onMouseDown:m=>{m.target===m.currentTarget&&o()},children:s.jsxs("div",{className:"gallery-model-content",children:[s.jsxs("div",{className:"sr-only",children:["Bildgalleri med ",P," bilder. Använd pilarna eller swipa för att navigera. Tryck på bilden för helskärm."]}),s.jsxs("div",{className:`lightbox-controls ${w?"is-hidden":""}`,children:[s.jsxs("div",{className:"lightbox-header-left",children:[s.jsxs("span",{className:"lightbox-counter",children:[D," / ",P]}),f&&x&&s.jsx("div",{className:"lightbox-categories desktop-only",children:f.map(m=>s.jsx("button",{className:`lightbox-category-btn ${C===m.id?"is-active":""}`,onClick:k=>{k.stopPropagation(),C!==m.id&&x(m.id)},children:m.name},m.id))})]}),s.jsx("button",{className:"gallery-close-button",onClick:o,"aria-label":"Stäng bildgalleri",ref:h,children:"×"})]}),s.jsxs("div",{className:"lightbox-stage",onTouchStart:y,onTouchMove:N,onTouchEnd:O,children:[n.length>1&&s.jsx("button",{type:"button",className:`lightbox-nav lightbox-nav--prev ${w?"is-hidden":""}`,onClick:m=>{m.stopPropagation(),i()},"aria-label":"Föregående bild",children:"‹"}),s.jsx("figure",{className:"lightbox-image-wrapper",children:s.jsx("img",{ref:v,src:r.original,alt:r.originalAlt||"Bild i galleriet",loading:"eager",onClick:A,className:"lightbox-image",style:{opacity:1}})}),n.length>1&&s.jsx("button",{type:"button",className:`lightbox-nav lightbox-nav--next ${w?"is-hidden":""}`,onClick:m=>{m.stopPropagation(),l()},"aria-label":"Nästa bild",children:"›"})]}),!w&&n.length>1&&s.jsxs("div",{className:"lightbox-footer",children:[f&&x&&s.jsx("div",{className:"lightbox-categories mobile-only",children:f.map(m=>s.jsx("button",{className:`lightbox-category-btn ${C===m.id?"is-active":""}`,onClick:k=>{k.stopPropagation(),C!==m.id&&x(m.id)},children:m.name},m.id))}),s.jsx("div",{className:"lightbox-thumbnails",role:"list",children:n.map((m,k)=>{var F;const T=k===t;return s.jsx("button",{type:"button",className:`lightbox-thumbnail ${T?"is-active":""}`,onClick:_=>{_.stopPropagation(),d(k)},"aria-label":`Gå till bild ${k+1}`,"aria-current":T||void 0,children:s.jsx("img",{src:m.thumbnail,alt:"",loading:"lazy"})},(F=m.filename)!=null?F:k)})}),s.jsx("p",{className:"lightbox-hint mobile-only",children:"Swipa för att bläddra • Tryck för helskärm"})]})]})})}U.propTypes={isOpen:c.bool.isRequired,images:c.array.isRequired,currentIndex:c.number.isRequired,currentImage:c.object,onClose:c.func.isRequired,onNext:c.func.isRequired,onPrevious:c.func.isRequired,onSelectImage:c.func.isRequired,activeCategory:c.string,onCategoryChange:c.func,categories:c.array,dialogRef:c.any,closeButtonRef:c.any};const ge={default:3,768:2};function le({images:e,onImageSelect:n}){return!e||e.length===0?null:s.jsxs("div",{className:"featured-gallery",children:[s.jsx(B,{breakpointCols:ge,className:"gallery-grid",columnClassName:"gallery-column",children:e.map((t,r)=>{var o;return s.jsx("div",{className:"gallery-thumbnail",onClick:()=>n(r),role:"button",tabIndex:0,"aria-label":`Öppna utvald bild ${r+1} av ${e.length} i lightbox`,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),n(r))},children:s.jsx("img",{src:t.thumbnail,alt:t.thumbnailAlt,loading:"eager"})},(o=t.filename)!=null?o:r)})}),s.jsx("div",{className:"featured-divider","aria-hidden":"true"})]})}le.propTypes={images:c.arrayOf(c.shape({thumbnail:c.string,thumbnailAlt:c.string,description:c.string,filename:c.string})).isRequired,onImageSelect:c.func.isRequired};const he=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),Y=(e,n)=>{if(n===0)return 0;const t=e%n;return t<0?t+n:t};function te(e,n){const[t,r]=a.useState(!1),[o,l]=a.useState(0),i=a.useRef(null),d=a.useRef(null),u=a.useRef(null),h=a.useRef(new Set),f=e.length>0,C=a.useCallback(g=>{f&&(u.current=document.activeElement,l(Y(g,e.length)),r(!0))},[f,e.length]),x=a.useCallback(()=>{r(!1)},[]),w=a.useCallback(g=>{f&&l(Y(g,e.length))},[f,e.length]),E=a.useCallback(()=>{f&&l(g=>(g+1)%e.length)},[f,e.length]),R=a.useCallback(()=>{f&&l(g=>(g-1+e.length)%e.length)},[f,e.length]);a.useEffect(()=>{if(!f){l(0);return}l(g=>g>=e.length?e.length-1:g<0?0:g)},[f,e.length]),a.useEffect(()=>{if(!t){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[t]),a.useEffect(()=>{if(t){const p=d.current;p&&p.focus({preventScroll:!0});return}const g=u.current;g&&typeof g.focus=="function"&&requestAnimationFrame(()=>{g.focus({preventScroll:!0}),u.current=null})},[t]),a.useEffect(()=>{if(!t)return;const g=p=>{p.key==="Escape"&&x()};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[t,x]),a.useEffect(()=>{if(!t||!f)return;const g=p=>{switch(p.key){case"ArrowRight":p.preventDefault(),E();break;case"ArrowLeft":p.preventDefault(),R();break;case"Home":p.preventDefault(),w(0);break;case"End":p.preventDefault(),w(e.length-1);break}};return document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[t,f,e.length,E,R,w]),a.useEffect(()=>{if(!t)return;const g=i.current;if(!g)return;const p=v=>{if(v.key!=="Tab")return;const b=Array.from(g.querySelectorAll(he)).filter(D=>!D.hasAttribute("aria-hidden"));if(b.length===0){v.preventDefault();return}const y=b[0],N=b[b.length-1],O=v.shiftKey,A=document.activeElement;!O&&A===N?(v.preventDefault(),y.focus()):O&&A===y&&(v.preventDefault(),N.focus())};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[t]);const S=a.useCallback(g=>{if(!f)return;const p=Y(g,e.length),v=e[p];if(!(v!=null&&v.original)||h.current.has(v.original))return;const b=new Image;b.src=v.original,h.current.add(v.original)},[f,e]);a.useEffect(()=>{h.current.clear(),l(0)},[n]),a.useEffect(()=>{!t||!f||(S(o),S(o+1),S(o-1))},[t,f,o,S]);const I=a.useMemo(()=>f?e[o]:null,[f,e,o]);return{isOpen:t,currentIndex:o,currentImage:I,openLightbox:C,closeLightbox:x,goToImage:w,goToNextImage:E,goToPreviousImage:R,dialogRef:i,closeButtonRef:d}}const q="hidden",ne="fixed",re="bottom";function pe(e){const[n,t]=a.useState(q),r=a.useRef(null),o=a.useRef(null),l=a.useRef(q),i=a.useCallback(d=>{l.current!==d&&(l.current=d,t(d))},[]);return a.useEffect(()=>{if(!e){i(q);return}const d=r.current;if(!d)return;let u=!1;const h=8,f=d.querySelector(".sentinel-top"),C=d.querySelector(".sentinel-bottom");let x=!1,w=!1,E,R;const S=b=>{let y=0,N=b;for(;N;)y+=N.offsetTop||0,N=N.offsetParent;return y},I=()=>{const b=r.current;if(!b)return;const y=S(b),N=b.offsetHeight,O=y+N,A=window.scrollY||window.pageYOffset,D=window.innerHeight||document.documentElement.clientHeight,P=A+D;if(P<y){i(q);return}if(A>=O){i(q);return}if(P>=O-h){i(re);return}i(ne)},g=()=>{u||(u=!0,requestAnimationFrame(()=>{I(),u=!1}))},p=()=>{I()};return"IntersectionObserver"in window&&f&&C&&(R=new IntersectionObserver(b=>{if(b.forEach(y=>{y.target===f&&(x=y.isIntersecting),y.target===C&&(w=y.isIntersecting)}),!x&&!w){const y=S(d),N=y+d.offsetHeight,O=window.scrollY||window.pageYOffset;if(O+(window.innerHeight||document.documentElement.clientHeight)<y||O>=N){i(q);return}}w?i(re):x&&i(ne)},{root:null,threshold:0}),R.observe(f),R.observe(C)),window.ResizeObserver&&(E=new ResizeObserver(()=>I()),E.observe(d)),d.querySelectorAll("img").forEach(b=>{b.complete||b.addEventListener("load",I,{once:!0})}),setTimeout(I,50),setTimeout(I,200),setTimeout(I,600),I(),window.addEventListener("scroll",g,{passive:!0}),window.addEventListener("resize",p),()=>{window.removeEventListener("scroll",g),window.removeEventListener("resize",p),E&&E.disconnect(),R&&R.disconnect()}},[e,i]),{mode:n,containerRef:r,buttonRef:o}}function xe(){const[e,n]=a.useState("alla"),[t,r]=a.useState(!1),[o,l]=a.useState(!1),i=a.useMemo(()=>W.categories.find(j=>j.id===e),[e]),d=a.useMemo(()=>i!=null&&i.images?i.images.map(j=>({original:j.path,thumbnail:j.path,description:j.displayName,originalAlt:j.displayName,thumbnailAlt:j.displayName,filename:j.filename,subcategory:j.subcategory})):[],[i]),u=a.useMemo(()=>{var Q;if(!((Q=G)!=null&&Q.featured)||G.featured.length===0)return[];const j=W.categories.find(M=>M.id==="alla");return j?G.featured.map(M=>{const L=j.images.find(ie=>ie.filename===M);return L?{original:L.path,thumbnail:L.path,description:L.displayName,originalAlt:L.displayName,thumbnailAlt:L.displayName,filename:L.filename,subcategory:L.subcategory}:null}).filter(Boolean):[]},[]),{isOpen:h,currentIndex:f,currentImage:C,openLightbox:x,closeLightbox:w,goToImage:E,goToNextImage:R,goToPreviousImage:S,dialogRef:I,closeButtonRef:g}=te(u,"featured"),{isOpen:p,currentIndex:v,currentImage:b,openLightbox:y,closeLightbox:N,goToImage:O,goToNextImage:A,goToPreviousImage:D,dialogRef:P,closeButtonRef:m}=te(d,e),{mode:k,containerRef:T,buttonRef:F}=pe(o),_=a.useCallback(()=>{l(j=>!j)},[]),se=a.useCallback(j=>{r(!0),n(j),l(!1),N(),setTimeout(()=>{r(!1)},300)},[N]),J=(i==null?void 0:i.name)||"Alla";return s.jsxs("div",{className:"storegarden-gallery",children:[s.jsx("div",{className:"gallery-logo-container",children:s.jsx("img",{src:ae,alt:"Storegården 7",className:"gallery-logo"})}),s.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),u.length>0&&s.jsx(le,{images:u,onImageSelect:x}),s.jsx(oe,{categories:W.categories,activeCategory:e,onCategoryChange:se}),s.jsx(V,{images:d,isLoading:t,onImageSelect:y,categoryName:J}),!o&&s.jsxs("button",{className:"show-more-button",onClick:_,"aria-expanded":o,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${d.length} bilder i galleriet`,children:["Visa alla bilder (",d.length,")"]}),o&&s.jsx(X,{images:d.slice(6),startIndex:6,totalCount:d.length,onImageSelect:y,categoryName:J,buttonMode:k,onToggle:_,containerRef:T,buttonRef:F}),s.jsx(U,{isOpen:h,images:u,currentIndex:f,currentImage:C,onClose:w,onNext:R,onPrevious:S,onSelectImage:E,dialogRef:I,closeButtonRef:g}),s.jsx(U,{isOpen:p,images:d,currentIndex:v,currentImage:b,onClose:N,onNext:A,onPrevious:D,onSelectImage:O,dialogRef:P,closeButtonRef:m,categories:W.categories,activeCategory:e,onCategoryChange:n})]})}export{xe as default};
