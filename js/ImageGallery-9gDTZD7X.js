import{j as s}from"./index-ClQgxUQ1.js";import{R as w,r as g}from"./vendor-DaLL37dA.js";import{c as B}from"./gallery-BsZh0IYC.js";function R(t,n){if(t==null)return{};var e=W(t,n),a,l;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(l=0;l<u.length;l++)a=u[l],!(n.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(e[a]=t[a])}return e}function W(t,n){if(t==null)return{};var e={},a=Object.keys(t),l,u;for(u=0;u<a.length;u++)l=a[u],!(n.indexOf(l)>=0)&&(e[l]=t[l]);return e}function v(){return v=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},v.apply(this,arguments)}function S(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),e.push.apply(e,a)}return e}function y(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?S(Object(e),!0).forEach(function(a){_(t,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):S(Object(e)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})}return t}function _(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}const M={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},A=2;class j extends w.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||A,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||A});let a=1/0,l=e.default||A;for(let u in e){const m=parseInt(u);m>0&&n<=m&&m<a&&(a=m,l=e[u])}l=Math.max(1,parseInt(l)||1),this.state.columnCount!==l&&this.setState({columnCount:l})}itemsInColumns(){const n=this.state.columnCount,e=new Array(n),a=w.Children.toArray(this.props.children);for(let l=0;l<a.length;l++){const u=l%n;e[u]||(e[u]=[]),e[u].push(a[l])}return e}renderColumns(){const{column:n,columnAttrs:e={},columnClassName:a}=this.props,l=this.itemsInColumns(),u=`${100/l.length}%`;let m=a;m&&typeof m!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof m=="undefined"&&(m="my-masonry-grid_column"));const p=y(y(y({},n),e),{},{style:y(y({},e.style),{},{width:u}),className:m});return l.map((i,c)=>w.createElement("div",v({},p,{key:c}),i))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:e,breakpointCols:a,columnClassName:l,columnAttrs:u,column:m,className:p}=n,i=R(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let c=p;return typeof p!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof p=="undefined"&&(c="my-masonry-grid")),w.createElement("div",v({},i,{className:c}),this.renderColumns())}}j.defaultProps=M;function F({categories:t,activeCategory:n,onCategoryChange:e}){const[a,l]=g.useState(0),u=g.useRef(null),m=g.useRef([]);g.useEffect(()=>{const i=t.findIndex(c=>c.id===n);i!==-1&&l(i)},[n,t]),g.useEffect(()=>{if(m.current[a]&&u.current){const i=m.current[a],c=u.current;if(c.scrollWidth>c.clientWidth){const f=i.offsetLeft,k=i.offsetWidth,C=c.clientWidth,N=f-C/2+k/2;c.scrollTo({left:N,behavior:"smooth"})}}},[a]);const p=(i,c)=>{l(c),e(i.id)};return s.jsx("div",{className:"category-toggle",children:s.jsx("div",{className:"category-toggle-container",ref:u,children:t.map((i,c)=>s.jsxs("button",{ref:f=>m.current[c]=f,className:`category-button ${c===a?"active":""}`,onClick:()=>p(i,c),"aria-label":`Visa ${i.name} (${i.images.length} bilder)`,children:[s.jsx("span",{className:"category-name",children:i.name}),s.jsxs("span",{className:"category-count",children:["(",i.images.length,")"]})]},i.id))})})}const T=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{id:"evenemang",name:"Evenemang",description:"Evenemang från Storegården 7",images:[2,4,6,8,10,12,14]},{id:"konst-keramik",name:"Konst & Keramik",description:"Konst och keramik från Storegården 7",images:[16,18,19,20]},{id:"lokal",name:"Lokal",description:"Lokal bilder från Storegården 7",images:[1,3,5,7,9,11,13,15,17]}],b={categories:T};function z(){const[t,n]=g.useState("alla"),[e,a]=g.useState(!1),[l,u]=g.useState(!1),m=(o,r)=>{if(r==="alla"){for(const d of b.categories)if(d.id!=="alla"&&d.images.includes(o))return`/images/${d.id}/slide${o}.jpg`;return`/images/slides/slide${o}.jpg`}return`/images/${r}/slide${o}.jpg`},p=g.useMemo(()=>{const o=new Set;return b.categories.forEach(d=>{d.id!=="alla"&&d.images.forEach(h=>o.add(h))}),Array.from(o).sort((d,h)=>d-h).map(d=>({original:m(d,"alla"),thumbnail:m(d,"alla"),description:`Bild ${d} från Storegården 7`,originalAlt:`Bild ${d}`,thumbnailAlt:`Miniatyr ${d}`,imageNumber:d}))},[]),i=g.useMemo(()=>{const o=b.categories.find(r=>r.id===t);return!o||t==="alla"?p:o.images.map(r=>({original:m(r,t),thumbnail:m(r,t),description:`Bild ${r} från Storegården 7`,originalAlt:`Bild ${r}`,thumbnailAlt:`Miniatyr ${r}`,imageNumber:r}))},[t]),[c,f]=g.useState(!1),[k,C]=g.useState(!1),[N,D]=g.useState(0),I=g.useCallback(()=>{f(!c)},[c]),x=g.useCallback(o=>{D(o),C(!0)},[]),E=g.useCallback(o=>{a(!0),n(o),f(!1),C(!1),setTimeout(()=>{a(!1)},300)},[]),$=g.useCallback(()=>{C(!1)},[]),O={default:3,768:2,480:1};return g.useEffect(()=>{if(!c){u(!1);return}const o=()=>{const r=document.querySelector(".expanded-gallery-container");if(!r)return;const h=r.getBoundingClientRect().bottom,L=window.innerHeight,P=h<L-10;u(P)};return window.addEventListener("scroll",o),o(),()=>{window.removeEventListener("scroll",o)}},[c]),s.jsxs("div",{className:"storegarden-gallery",children:[s.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),s.jsx(F,{categories:b.categories,activeCategory:t,onCategoryChange:E}),e?s.jsx(j,{breakpointCols:O,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((o,r)=>s.jsx("div",{className:"gallery-thumbnail skeleton-item",children:s.jsx("div",{className:"skeleton-image",style:{height:`${200+r%3*50}px`}})},r))}):s.jsx(j,{breakpointCols:O,className:"gallery-grid",columnClassName:"gallery-column",children:i.slice(0,6).map((o,r)=>{var d;return s.jsxs("div",{className:"gallery-thumbnail",onClick:()=>x(r),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+1} av ${i.length} i lightbox`,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),x(r))},children:[s.jsx("img",{src:o.thumbnail,alt:o.thumbnailAlt,loading:"eager"}),s.jsxs("div",{className:"image-overlay",children:[s.jsx("span",{className:"image-category",children:((d=b.categories.find(h=>h.id===t))==null?void 0:d.name)||"Alla"}),s.jsxs("span",{className:"image-number",children:["#",o.imageNumber]})]})]},r)})}),!c&&s.jsxs("button",{className:"show-more-button",onClick:I,"aria-expanded":c,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${i.length} bilder i galleriet`,children:["Visa alla bilder (",i.length,")"]}),c&&s.jsxs("div",{className:"expanded-gallery-container",children:[s.jsx(j,{breakpointCols:O,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:i.slice(6).map((o,r)=>{var d;return s.jsxs("div",{className:"gallery-thumbnail",onClick:()=>x(r+6),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+7} av ${i.length} i lightbox`,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),x(r+6))},children:[s.jsx("img",{src:o.thumbnail,alt:o.thumbnailAlt,loading:"lazy"}),s.jsxs("div",{className:"image-overlay",children:[s.jsx("span",{className:"image-category",children:((d=b.categories.find(h=>h.id===t))==null?void 0:d.name)||"Alla"}),s.jsxs("span",{className:"image-number",children:["#",o.imageNumber]})]})]},r+6)})}),s.jsx("button",{className:`hide-images-button ${l?"stuck":""}`,onClick:I,"aria-label":"Dölj utökade galleri bilder",children:"Dölj bilder"})]}),k&&s.jsx("div",{className:"gallery-modal",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",children:s.jsxs("div",{className:"gallery-modal-content",children:[s.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",i.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),s.jsx("button",{className:"gallery-close-button",onClick:$,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",children:"×"}),s.jsx(B,{items:i,startIndex:N,showThumbnails:!0,showFullscreenButton:!0,showPlayButton:!1,showIndex:!0,showBullets:!1,infinite:!0,slideDuration:300,slideInterval:2e3})]})})]})}export{z as default};
