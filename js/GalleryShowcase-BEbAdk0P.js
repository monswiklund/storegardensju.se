import{j as i,P as l,l as oe}from"./index-Do-KB6Gx.js";import{b as u,e as P}from"./vendor-ASO3vaGF.js";function Z({categories:n,activeCategory:a,onCategoryChange:e}){const[r,t]=u.useState(0),o=u.useRef(null),s=u.useRef([]);u.useEffect(()=>{const g=n.findIndex(p=>p.id===a);g!==-1&&t(g)},[a,n]),u.useEffect(()=>{if(s.current[r]&&o.current){const g=s.current[r],p=o.current;if(p.scrollWidth>p.clientWidth){const c=g.offsetLeft,f=g.offsetWidth,v=p.clientWidth,w=c-v/2+f/2;p.scrollTo({left:w,behavior:"smooth"})}}},[r]);const d=(g,p)=>{t(p),e(g.id)};return i.jsx("div",{className:"category-toggle",children:i.jsx("div",{className:"category-toggle-container",ref:o,children:n.map((g,p)=>i.jsxs("button",{ref:c=>s.current[p]=c,className:`category-button ${p===r?"active":""}`,onClick:()=>d(g,p),"aria-label":`Visa ${g.name} (${g.images.length} bilder)`,children:[i.jsx("span",{className:"category-name",children:g.name}),i.jsxs("span",{className:"category-count",children:["(",g.images.length,")"]})]},g.id))})})}Z.propTypes={categories:l.arrayOf(l.shape({id:l.string.isRequired,name:l.string.isRequired,images:l.array.isRequired})).isRequired,activeCategory:l.string.isRequired,onCategoryChange:l.func.isRequired};const se=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Övervåning - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Övervåning - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Övervåning - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Övervåning - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Övervåning - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Undervåning - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Undervåning - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Undervåning - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Undervåning - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Undervåning - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Undervåning - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Undervåning - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Undervåning - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Undervåning - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Undervåning - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Undervåning - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Undervåning - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Undervåning - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Undervåning - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Undervåning - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Undervåning - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Undervåning - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Undervåning - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Ute - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Ute - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Ute - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]},{id:"undervaning",name:"Undervåning",description:"Nedre våningen, kök och serviceområden",images:[{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Undervåning - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Undervåning - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Undervåning - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Undervåning - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Undervåning - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Undervåning - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Undervåning - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Undervåning - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Undervåning - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Undervåning - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Undervåning - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Undervåning - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Undervåning - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Undervåning - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Undervåning - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Undervåning - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Undervåning - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Undervåning - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"}]},{id:"overvaning",name:"Övervåning",description:"Övre våningen på Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Övervåning - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Övervåning - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Övervåning - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Övervåning - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Övervåning - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"}]},{id:"ute",name:"Ute",description:"Utemiljö och toaletter",images:[{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Ute - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Ute - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Ute - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]}],K={categories:se},ue=["lokal-upper-1.webp","lokal-upper-5.webp","lokal-under-1.webp","lokal-under-10.webp","lokal-under-11.webp","lokal-service-3.webp","lokal-ute-1.webp"],T={featured:ue};function ce(n,a){if(n==null)return{};var e=de(n,a),r,t;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(t=0;t<o.length;t++)r=o[t],!(a.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r])}return e}function de(n,a){if(n==null)return{};var e={},r=Object.keys(n),t,o;for(o=0;o<r.length;o++)t=r[o],!(a.indexOf(t)>=0)&&(e[t]=n[t]);return e}function B(){return B=Object.assign||function(n){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},B.apply(this,arguments)}function Y(n,a){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);a&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function L(n){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?Y(Object(e),!0).forEach(function(r){ge(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Y(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function ge(n,a,e){return a in n?Object.defineProperty(n,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[a]=e,n}const me={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},z=2;class q extends P.Component{constructor(a){super(a),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||z,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const a=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||z});let r=1/0,t=e.default||z;for(let o in e){const s=parseInt(o);s>0&&a<=s&&s<r&&(r=s,t=e[o])}t=Math.max(1,parseInt(t)||1),this.state.columnCount!==t&&this.setState({columnCount:t})}itemsInColumns(){const a=this.state.columnCount,e=new Array(a),r=P.Children.toArray(this.props.children);for(let t=0;t<r.length;t++){const o=t%a;e[o]||(e[o]=[]),e[o].push(r[t])}return e}renderColumns(){const{column:a,columnAttrs:e={},columnClassName:r}=this.props,t=this.itemsInColumns(),o=`${100/t.length}%`;let s=r;s&&typeof s!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof s=="undefined"&&(s="my-masonry-grid_column"));const d=L(L(L({},a),e),{},{style:L(L({},e.style),{},{width:o}),className:s});return t.map((g,p)=>P.createElement("div",B({},d,{key:p}),g))}logDeprecated(a){console.error("[Masonry]",a)}render(){const a=this.props,{children:e,breakpointCols:r,columnClassName:t,columnAttrs:o,column:s,className:d}=a,g=ce(a,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let p=d;return typeof d!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof d=="undefined"&&(p="my-masonry-grid")),P.createElement("div",B({},g,{className:p}),this.renderColumns())}}q.defaultProps=me;const V={default:3,768:2};function W({images:n,isLoading:a,onImageSelect:e,categoryName:r}){return a?i.jsx(q,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((t,o)=>i.jsx("div",{className:"gallery-thumbnail skeleton-item",children:i.jsx("div",{className:"skeleton-image",style:{height:`${200+o%3*50}px`}})},o))}):i.jsx(q,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:n.slice(0,6).map((t,o)=>i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>e(o),role:"button",tabIndex:0,"aria-label":`Öppna bild ${o+1} av ${n.length} i lightbox`,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e(o))},children:[i.jsx("img",{src:t.thumbnail,alt:t.thumbnailAlt,loading:"eager"}),i.jsx("div",{className:"image-overlay",children:i.jsx("span",{className:"image-category",children:r!=null?r:"Alla"})})]},o))})}W.propTypes={images:l.arrayOf(l.shape({thumbnail:l.string,thumbnailAlt:l.string})).isRequired,isLoading:l.bool.isRequired,onImageSelect:l.func.isRequired,categoryName:l.string};W.defaultProps={categoryName:"Alla"};const pe={default:3,768:2};function _({images:n,startIndex:a,totalCount:e,onImageSelect:r,categoryName:t,buttonMode:o,onToggle:s,containerRef:d,buttonRef:g}){return i.jsxs("div",{className:"expanded-gallery-container",ref:d,children:[i.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),i.jsx(q,{breakpointCols:pe,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:n.map((p,c)=>{const f=c+a;return i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>r(f),role:"button",tabIndex:0,"aria-label":`Öppna bild ${f+1} av ${e} i lightbox`,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),r(f))},children:[i.jsx("img",{src:p.thumbnail,alt:p.thumbnailAlt,loading:"lazy"}),i.jsx("div",{className:"image-overlay",children:i.jsx("span",{className:"image-category",children:t!=null?t:"Alla"})})]},f)})}),i.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),i.jsx("button",{ref:g,className:`hide-images-button ${o==="fixed"?"is-fixed":""} ${o==="bottom"?"at-bottom":""} ${o==="hidden"?"is-hidden":""}`,onClick:s,"aria-label":"Dölj utökade galleri bilder","aria-hidden":o==="hidden",children:"Dölj bilder"})]})}_.propTypes={images:l.arrayOf(l.shape({thumbnail:l.string,thumbnailAlt:l.string})).isRequired,startIndex:l.number,totalCount:l.number,onImageSelect:l.func.isRequired,categoryName:l.string,buttonMode:l.string.isRequired,onToggle:l.func.isRequired,containerRef:l.shape({current:l.any}),buttonRef:l.shape({current:l.any})};_.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function $({isOpen:n,images:a,currentIndex:e,currentImage:r,onClose:t,onNext:o,onPrevious:s,onSelectImage:d,dialogRef:g,closeButtonRef:p}){return n?i.jsx("div",{className:"gallery-model",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",ref:g,onMouseDown:c=>{c.target===c.currentTarget&&t()},children:i.jsxs("div",{className:"gallery-model-content",children:[i.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",a.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),i.jsx("button",{className:"gallery-close-button",onClick:t,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",ref:p,type:"button",children:"×"}),r?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"lightbox-stage",children:[a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--prev",onClick:s,"aria-label":"Visa föregående bild",children:"‹"}),i.jsx("figure",{className:"lightbox-image-wrapper",children:i.jsx("img",{src:r.original,alt:r.originalAlt||r.description||"Bild i galleriet",loading:"eager"})}),a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--next",onClick:o,"aria-label":"Visa nästa bild",children:"›"})]}),i.jsxs("div",{className:"lightbox-footer",children:[i.jsxs("span",{className:"lightbox-counter","aria-live":"polite",children:[e+1," / ",a.length]}),a.length>1&&i.jsx("div",{className:"lightbox-thumbnails",role:"list",children:a.map((c,f)=>{var w;const v=f===e;return i.jsx("button",{type:"button",className:`lightbox-thumbnail ${v?"is-active":""}`,onClick:()=>d(f),"aria-label":`Gå till bild ${f+1} av ${a.length}`,"aria-current":v?"true":void 0,children:i.jsx("img",{src:c.thumbnail,alt:c.thumbnailAlt,loading:"lazy"})},(w=c.filename)!=null?w:f)})})]})]}):i.jsx("div",{className:"lightbox-empty",children:i.jsx("p",{children:"Inga bilder tillgängliga i denna kategori."})})]})}):null}$.propTypes={isOpen:l.bool.isRequired,images:l.arrayOf(l.shape({original:l.string,originalAlt:l.string,description:l.string,thumbnail:l.string,thumbnailAlt:l.string,filename:l.string})).isRequired,currentIndex:l.number.isRequired,currentImage:l.shape({original:l.string,originalAlt:l.string,description:l.string}),onClose:l.func.isRequired,onNext:l.func.isRequired,onPrevious:l.func.isRequired,onSelectImage:l.func.isRequired,dialogRef:l.shape({current:l.any}).isRequired,closeButtonRef:l.shape({current:l.any}).isRequired};$.defaultProps={currentImage:null};const be={default:3,768:2};function ee({images:n,onImageSelect:a}){return!n||n.length===0?null:i.jsxs("div",{className:"featured-gallery",children:[i.jsx(q,{breakpointCols:be,className:"gallery-grid",columnClassName:"gallery-column",children:n.map((e,r)=>{var t;return i.jsx("div",{className:"gallery-thumbnail",onClick:()=>a(r),role:"button",tabIndex:0,"aria-label":`Öppna utvald bild ${r+1} av ${n.length} i lightbox`,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),a(r))},children:i.jsx("img",{src:e.thumbnail,alt:e.thumbnailAlt,loading:"eager"})},(t=e.filename)!=null?t:r)})}),i.jsx("div",{className:"featured-divider","aria-hidden":"true"})]})}ee.propTypes={images:l.arrayOf(l.shape({thumbnail:l.string,thumbnailAlt:l.string,description:l.string,filename:l.string})).isRequired,onImageSelect:l.func.isRequired};const fe=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),H=(n,a)=>{if(a===0)return 0;const e=n%a;return e<0?e+a:e};function X(n,a){const[e,r]=u.useState(!1),[t,o]=u.useState(0),s=u.useRef(null),d=u.useRef(null),g=u.useRef(null),p=u.useRef(new Set),c=n.length>0,f=u.useCallback(m=>{c&&(g.current=document.activeElement,o(H(m,n.length)),r(!0))},[c,n.length]),v=u.useCallback(()=>{r(!1)},[]),w=u.useCallback(m=>{c&&o(H(m,n.length))},[c,n.length]),I=u.useCallback(()=>{c&&o(m=>(m+1)%n.length)},[c,n.length]),j=u.useCallback(()=>{c&&o(m=>(m-1+n.length)%n.length)},[c,n.length]);u.useEffect(()=>{if(!c){o(0);return}o(m=>m>=n.length?n.length-1:m<0?0:m)},[c,n.length]),u.useEffect(()=>{if(!e){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[e]),u.useEffect(()=>{if(e){const b=d.current;b&&b.focus({preventScroll:!0});return}const m=g.current;m&&typeof m.focus=="function"&&requestAnimationFrame(()=>{m.focus({preventScroll:!0}),g.current=null})},[e]),u.useEffect(()=>{if(!e)return;const m=b=>{b.key==="Escape"&&v()};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,v]),u.useEffect(()=>{if(!e||!c)return;const m=b=>{switch(b.key){case"ArrowRight":b.preventDefault(),I();break;case"ArrowLeft":b.preventDefault(),j();break;case"Home":b.preventDefault(),w(0);break;case"End":b.preventDefault(),w(n.length-1);break}};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,c,n.length,I,j,w]),u.useEffect(()=>{if(!e)return;const m=s.current;if(!m)return;const b=N=>{if(N.key!=="Tab")return;const y=Array.from(m.querySelectorAll(fe)).filter(U=>!U.hasAttribute("aria-hidden"));if(y.length===0){N.preventDefault();return}const h=y[0],x=y[y.length-1],R=N.shiftKey,E=document.activeElement;!R&&E===x?(N.preventDefault(),h.focus()):R&&E===h&&(N.preventDefault(),x.focus())};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[e]);const A=u.useCallback(m=>{if(!c)return;const b=H(m,n.length),N=n[b];if(!(N!=null&&N.original)||p.current.has(N.original))return;const y=new Image;y.src=N.original,p.current.add(N.original)},[c,n]);u.useEffect(()=>{p.current.clear()},[a]),u.useEffect(()=>{!e||!c||(A(t),A(t+1),A(t-1))},[e,c,t,A]);const C=u.useMemo(()=>c?n[t]:null,[c,n,t]);return{isOpen:e,currentIndex:t,currentImage:C,openLightbox:f,closeLightbox:v,goToImage:w,goToNextImage:I,goToPreviousImage:j,dialogRef:s,closeButtonRef:d}}const S="hidden",J="fixed",Q="bottom";function ye(n){const[a,e]=u.useState(S),r=u.useRef(null),t=u.useRef(null),o=u.useRef(S),s=u.useCallback(d=>{o.current!==d&&(o.current=d,e(d))},[]);return u.useEffect(()=>{if(!n){s(S);return}const d=r.current;if(!d)return;let g=!1;const p=8,c=d.querySelector(".sentinel-top"),f=d.querySelector(".sentinel-bottom");let v=!1,w=!1,I,j;const A=y=>{let h=0,x=y;for(;x;)h+=x.offsetTop||0,x=x.offsetParent;return h},C=()=>{const y=r.current;if(!y)return;const h=A(y),x=y.offsetHeight,R=h+x,E=window.scrollY||window.pageYOffset,U=window.innerHeight||document.documentElement.clientHeight,D=E+U;if(D<h){s(S);return}if(E>=R){s(S);return}if(D>=R-p){s(Q);return}s(J)},m=()=>{g||(g=!0,requestAnimationFrame(()=>{C(),g=!1}))},b=()=>{C()};return"IntersectionObserver"in window&&c&&f&&(j=new IntersectionObserver(y=>{if(y.forEach(h=>{h.target===c&&(v=h.isIntersecting),h.target===f&&(w=h.isIntersecting)}),!v&&!w){const h=A(d),x=h+d.offsetHeight,R=window.scrollY||window.pageYOffset;if(R+(window.innerHeight||document.documentElement.clientHeight)<h||R>=x){s(S);return}}w?s(Q):v&&s(J)},{root:null,threshold:0}),j.observe(c),j.observe(f)),window.ResizeObserver&&(I=new ResizeObserver(()=>C()),I.observe(d)),d.querySelectorAll("img").forEach(y=>{y.complete||y.addEventListener("load",C,{once:!0})}),setTimeout(C,50),setTimeout(C,200),setTimeout(C,600),C(),window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",b),()=>{window.removeEventListener("scroll",m),window.removeEventListener("resize",b),I&&I.disconnect(),j&&j.disconnect()}},[n,s]),{mode:a,containerRef:r,buttonRef:t}}function ke(){const[n,a]=u.useState("alla"),[e,r]=u.useState(!1),[t,o]=u.useState(!1),s=u.useMemo(()=>K.categories.find(k=>k.id===n),[n]),d=u.useMemo(()=>s!=null&&s.images?s.images.map(k=>({original:k.path,thumbnail:k.path,description:k.displayName,originalAlt:k.displayName,thumbnailAlt:k.displayName,filename:k.filename,subcategory:k.subcategory})):[],[s]),g=u.useMemo(()=>{if(!(T!=null&&T.featured)||T.featured.length===0)return[];const k=K.categories.find(F=>F.id==="alla");return k?T.featured.map(F=>{const O=k.images.find(ie=>ie.filename===F);return O?{original:O.path,thumbnail:O.path,description:O.displayName,originalAlt:O.displayName,thumbnailAlt:O.displayName,filename:O.filename,subcategory:O.subcategory}:null}).filter(Boolean):[]},[]),{isOpen:p,currentIndex:c,currentImage:f,openLightbox:v,closeLightbox:w,goToImage:I,goToNextImage:j,goToPreviousImage:A,dialogRef:C,closeButtonRef:m}=X(g,"featured"),{isOpen:b,currentIndex:N,currentImage:y,openLightbox:h,closeLightbox:x,goToImage:R,goToNextImage:E,goToPreviousImage:U,dialogRef:D,closeButtonRef:ne}=X(d,n),{mode:re,containerRef:ae,buttonRef:te}=ye(t),M=u.useCallback(()=>{o(k=>!k)},[]),le=u.useCallback(k=>{r(!0),a(k),o(!1),x(),setTimeout(()=>{r(!1)},300)},[x]),G=(s==null?void 0:s.name)||"Alla";return i.jsxs("div",{className:"storegarden-gallery",children:[i.jsx("div",{className:"gallery-logo-container",children:i.jsx("img",{src:oe,alt:"Storegården 7",className:"gallery-logo"})}),i.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),g.length>0&&i.jsx(ee,{images:g,onImageSelect:v}),i.jsx(Z,{categories:K.categories,activeCategory:n,onCategoryChange:le}),i.jsx(W,{images:d,isLoading:e,onImageSelect:h,categoryName:G}),!t&&i.jsxs("button",{className:"show-more-button",onClick:M,"aria-expanded":t,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${d.length} bilder i galleriet`,children:["Visa alla bilder (",d.length,")"]}),t&&i.jsx(_,{images:d.slice(6),startIndex:6,totalCount:d.length,onImageSelect:h,categoryName:G,buttonMode:re,onToggle:M,containerRef:ae,buttonRef:te}),i.jsx($,{isOpen:p,images:g,currentIndex:c,currentImage:f,onClose:w,onNext:j,onPrevious:A,onSelectImage:I,dialogRef:C,closeButtonRef:m}),i.jsx($,{isOpen:b,images:d,currentIndex:N,currentImage:y,onClose:x,onNext:E,onPrevious:U,onSelectImage:R,dialogRef:D,closeButtonRef:ne})]})}export{ke as default};
