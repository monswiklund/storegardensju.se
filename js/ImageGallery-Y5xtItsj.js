import{j as i}from"./index-BUdj9n84.js";import{R as $,r as d}from"./vendor-DaLL37dA.js";import{c as Z}from"./gallery-BsZh0IYC.js";function ee(t,n){if(t==null)return{};var e=te(t,n),s,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(l=0;l<a.length;l++)s=a[l],!(n.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(e[s]=t[s])}return e}function te(t,n){if(t==null)return{};var e={},s=Object.keys(t),l,a;for(a=0;a<s.length;a++)l=s[a],!(n.indexOf(l)>=0)&&(e[l]=t[l]);return e}function P(){return P=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},P.apply(this,arguments)}function V(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),e.push.apply(e,s)}return e}function A(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?V(Object(e),!0).forEach(function(s){ne(t,s,e[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):V(Object(e)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(e,s))})}return t}function ne(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}const se={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},z=2;class L extends $.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||z,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||z});let s=1/0,l=e.default||z;for(let a in e){const h=parseInt(a);h>0&&n<=h&&h<s&&(s=h,l=e[a])}l=Math.max(1,parseInt(l)||1),this.state.columnCount!==l&&this.setState({columnCount:l})}itemsInColumns(){const n=this.state.columnCount,e=new Array(n),s=$.Children.toArray(this.props.children);for(let l=0;l<s.length;l++){const a=l%n;e[a]||(e[a]=[]),e[a].push(s[l])}return e}renderColumns(){const{column:n,columnAttrs:e={},columnClassName:s}=this.props,l=this.itemsInColumns(),a=`${100/l.length}%`;let h=s;h&&typeof h!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof h=="undefined"&&(h="my-masonry-grid_column"));const p=A(A(A({},n),e),{},{style:A(A({},e.style),{},{width:a}),className:h});return l.map((u,m)=>$.createElement("div",P({},p,{key:m}),u))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:e,breakpointCols:s,columnClassName:l,columnAttrs:a,column:h,className:p}=n,u=ee(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let m=p;return typeof p!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof p=="undefined"&&(m="my-masonry-grid")),$.createElement("div",P({},u,{className:m}),this.renderColumns())}}L.defaultProps=se;function le({categories:t,activeCategory:n,onCategoryChange:e}){const[s,l]=d.useState(0),a=d.useRef(null),h=d.useRef([]);d.useEffect(()=>{const u=t.findIndex(m=>m.id===n);u!==-1&&l(u)},[n,t]),d.useEffect(()=>{if(h.current[s]&&a.current){const u=h.current[s],m=a.current;if(m.scrollWidth>m.clientWidth){const y=u.offsetLeft,B=u.offsetWidth,I=m.clientWidth,b=y-I/2+B/2;m.scrollTo({left:b,behavior:"smooth"})}}},[s]);const p=(u,m)=>{l(m),e(u.id)};return i.jsx("div",{className:"category-toggle",children:i.jsx("div",{className:"category-toggle-container",ref:a,children:t.map((u,m)=>i.jsxs("button",{ref:y=>h.current[m]=y,className:`category-button ${m===s?"active":""}`,onClick:()=>p(u,m),"aria-label":`Visa ${u.name} (${u.images.length} bilder)`,children:[i.jsx("span",{className:"category-name",children:u.name}),i.jsxs("span",{className:"category-count",children:["(",u.images.length,")"]})]},u.id))})})}const oe=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{id:"evenemang",name:"Evenemang",description:"Evenemang från Storegården 7",images:[2,4,6,8,10,12,14]},{id:"konst-keramik",name:"Konst & Keramik",description:"Konst och keramik från Storegården 7",images:[16,18,19,20]},{id:"lokal",name:"Lokal",description:"Lokal bilder från Storegården 7",images:[1,3,5,7,9,11,13,15,17]}],j={categories:oe};function de(){const[t,n]=d.useState("alla"),[e,s]=d.useState(!1),[l,a]=d.useState(!1),[h,p]=d.useState(!1),[u,m]=d.useState(0),[y,B]=d.useState("hidden"),I=d.useRef("hidden"),b=d.useCallback(o=>{I.current!==o&&(I.current=o,B(o))},[]),N=d.useRef(null),G=d.useRef(null),S=(o,r)=>{if(r==="alla"){for(const c of j.categories)if(c.id!=="alla"&&c.images.includes(o))return`/images/${c.id}/slide${o}.jpg`;return`/images/slides/slide${o}.jpg`}return`/images/${r}/slide${o}.jpg`},F=d.useMemo(()=>{const o=new Set;return j.categories.forEach(c=>{c.id!=="alla"&&c.images.forEach(f=>o.add(f))}),Array.from(o).sort((c,f)=>c-f).map(c=>({original:S(c,"alla"),thumbnail:S(c,"alla"),description:`Bild ${c} från Storegården 7`,originalAlt:`Bild ${c}`,thumbnailAlt:`Miniatyr ${c}`,imageNumber:c}))},[]),w=d.useMemo(()=>{const o=j.categories.find(r=>r.id===t);return!o||t==="alla"?F:o.images.map(r=>({original:S(r,t),thumbnail:S(r,t),description:`Bild ${r} från Storegården 7`,originalAlt:`Bild ${r}`,thumbnailAlt:`Miniatyr ${r}`,imageNumber:r}))},[t,F]),q=d.useCallback(()=>{a(!l)},[l]),E=d.useCallback(o=>{m(o),p(!0)},[]),J=d.useCallback(o=>{s(!0),n(o),a(!1),p(!1),setTimeout(()=>{s(!1)},300)},[]),Q=d.useCallback(()=>{p(!1)},[]);d.useEffect(()=>{if(!l){b("hidden");return}const o=N.current;if(!o)return;let r=!1;const c=8,f=C=>{let g=0,x=C;for(;x;)g+=x.offsetTop||0,x=x.offsetParent;return g};let T=!1,M=!1;const W=o.querySelector(".sentinel-top"),_=o.querySelector(".sentinel-bottom");let k;"IntersectionObserver"in window&&W&&_&&(k=new IntersectionObserver(C=>{if(C.forEach(g=>{g.target===W&&(T=g.isIntersecting),g.target===_&&(M=g.isIntersecting)}),!T&&!M){const g=f(o),x=g+o.offsetHeight,O=window.scrollY||window.pageYOffset;if(O+(window.innerHeight||document.documentElement.clientHeight)<g||O>=x){b("hidden");return}}M?b("bottom"):T&&b("fixed")},{root:null,threshold:0}),k.observe(W),k.observe(_));const v=()=>{if(!N.current)return;const C=N.current,g=f(C),x=C.offsetHeight,O=g+x,H=window.scrollY||window.pageYOffset,X=window.innerHeight||document.documentElement.clientHeight,U=H+X;if(U<g){b("hidden");return}if(H>=O){b("hidden");return}if(U>=O-c){b("bottom");return}b("fixed")},K=()=>{r||(r=!0,requestAnimationFrame(()=>{v(),r=!1}))},Y=()=>v();let D;return window.ResizeObserver&&(D=new ResizeObserver(()=>v()),D.observe(o)),o.querySelectorAll("img").forEach(C=>{C.complete||C.addEventListener("load",v,{once:!0})}),setTimeout(v,50),setTimeout(v,200),setTimeout(v,600),v(),window.addEventListener("scroll",K,{passive:!0}),window.addEventListener("resize",Y),()=>{window.removeEventListener("scroll",K),window.removeEventListener("resize",Y),D&&D.disconnect(),k&&k.disconnect()}},[l,b]);const R={default:3,768:2,480:1};return i.jsxs("div",{className:"storegarden-gallery",children:[i.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),i.jsx(le,{categories:j.categories,activeCategory:t,onCategoryChange:J}),e?i.jsx(L,{breakpointCols:R,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((o,r)=>i.jsx("div",{className:"gallery-thumbnail skeleton-item",children:i.jsx("div",{className:"skeleton-image",style:{height:`${200+r%3*50}px`}})},r))}):i.jsx(L,{breakpointCols:R,className:"gallery-grid",columnClassName:"gallery-column",children:w.slice(0,6).map((o,r)=>{var c;return i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>E(r),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+1} av ${w.length} i lightbox`,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),E(r))},children:[i.jsx("img",{src:o.thumbnail,alt:o.thumbnailAlt,loading:"eager"}),i.jsxs("div",{className:"image-overlay",children:[i.jsx("span",{className:"image-category",children:((c=j.categories.find(f=>f.id===t))==null?void 0:c.name)||"Alla"}),i.jsxs("span",{className:"image-number",children:["#",o.imageNumber]})]})]},r)})}),!l&&i.jsxs("button",{className:"show-more-button",onClick:q,"aria-expanded":l,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${w.length} bilder i galleriet`,children:["Visa alla bilder (",w.length,")"]}),l&&i.jsxs("div",{className:"expanded-gallery-container",ref:N,children:[i.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),i.jsx(L,{breakpointCols:R,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:w.slice(6).map((o,r)=>{var c;return i.jsxs("div",{className:"gallery-thumbnail",onClick:()=>E(r+6),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+7} av ${w.length} i lightbox`,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),E(r+6))},children:[i.jsx("img",{src:o.thumbnail,alt:o.thumbnailAlt,loading:"lazy"}),i.jsxs("div",{className:"image-overlay",children:[i.jsx("span",{className:"image-category",children:((c=j.categories.find(f=>f.id===t))==null?void 0:c.name)||"Alla"}),i.jsxs("span",{className:"image-number",children:["#",o.imageNumber]})]})]},r+6)})}),i.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),i.jsx("button",{ref:G,className:`hide-images-button ${y==="fixed"?"is-fixed":""} ${y==="bottom"?"at-bottom":""} ${y==="hidden"?"is-hidden":""}`,onClick:q,"aria-label":"Dölj utökade galleri bilder","aria-hidden":y==="hidden",children:"Dölj bilder"})]}),h&&i.jsx("div",{className:"gallery-modal",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",children:i.jsxs("div",{className:"gallery-modal-content",children:[i.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",w.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),i.jsx("button",{className:"gallery-close-button",onClick:Q,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",children:"×"}),i.jsx(Z,{items:w,startIndex:u,showThumbnails:!0,showFullscreenButton:!0,showPlayButton:!1,showIndex:!0,showBullets:!1,infinite:!0,slideDuration:300,slideInterval:2e3})]})})]})}export{de as default};
