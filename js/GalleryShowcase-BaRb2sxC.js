import{j as o,P as u,l as ie}from"./index-DsdHlrQm.js";import{b as s,h as W}from"./vendor-kgT0sz4b.js";function te({categories:e,activeCategory:a,onCategoryChange:n}){const[t,r]=s.useState(0),l=s.useRef(null),i=s.useRef([]);s.useEffect(()=>{const c=e.findIndex(b=>b.id===a);c!==-1&&r(c)},[a,e]),s.useEffect(()=>{if(i.current[t]&&l.current){const c=i.current[t],b=l.current;if(b.scrollWidth>b.clientWidth){const g=c.offsetLeft,v=c.offsetWidth,k=b.clientWidth,w=g-k/2+v/2;b.scrollTo({left:w,behavior:"smooth"})}}},[t]);const d=(c,b)=>{r(b),n(c.id)};return o.jsx("div",{className:"category-toggle",children:o.jsx("div",{className:"category-toggle-container",ref:l,children:e.map((c,b)=>o.jsxs("button",{ref:g=>i.current[b]=g,className:`category-button ${b===t?"active":""}`,onClick:()=>d(c,b),"aria-label":`Visa ${c.name} (${c.images.length} bilder)`,children:[o.jsx("span",{className:"category-name",children:c.name}),o.jsxs("span",{className:"category-count",children:["(",c.images.length,")"]})]},c.id))})})}te.propTypes={categories:u.arrayOf(u.shape({id:u.string.isRequired,name:u.string.isRequired,images:u.array.isRequired})).isRequired,activeCategory:u.string.isRequired,onCategoryChange:u.func.isRequired};const se=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Loftet - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Loftet - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Loftet - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Loftet - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Loftet - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Ladan - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Ladan - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Ladan - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Ladan - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Ladan - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Ladan - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Ladan - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Ladan - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Ladan - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Ladan - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Ladan - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Ladan - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Ladan - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Ladan - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Ladan - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Ladan - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Ladan - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Ladan - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Övrigt - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Övrigt - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Övrigt - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]},{id:"undervaning",name:"Ladan",description:"Nedre våningen, kök och serviceområden",images:[{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Ladan - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Ladan - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Ladan - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Ladan - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Ladan - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Ladan - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Ladan - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Ladan - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Ladan - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Ladan - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Ladan - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Ladan - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Ladan - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Ladan - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Ladan - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Ladan - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Ladan - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Ladan - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"}]},{id:"overvaning",name:"Loftet",description:"Övre våningen på Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Loftet - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Loftet - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Loftet - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Loftet - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Loftet - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"}]},{id:"ute",name:"Övrigt",description:"Utemiljö och toaletter",images:[{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Övrigt - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Övrigt - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Övrigt - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]}],z={categories:se},ue=["lokal-upper-1.webp","lokal-upper-5.webp","lokal-under-1.webp","lokal-under-10.webp","lokal-under-11.webp","lokal-service-3.webp","lokal-ute-1.webp"],$={featured:ue};function ce(e,a){if(e==null)return{};var n=de(e,a),t,r;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],!(a.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function de(e,a){if(e==null)return{};var n={},t=Object.keys(e),r,l;for(l=0;l<t.length;l++)r=t[l],!(a.indexOf(r)>=0)&&(n[r]=e[r]);return n}function H(){return H=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},H.apply(this,arguments)}function Q(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)}return n}function B(e){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?Q(Object(n),!0).forEach(function(t){ge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ge(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}const me={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},G=2;class F extends W.Component{constructor(a){super(a),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let n;this.props.breakpointCols&&this.props.breakpointCols.default?n=this.props.breakpointCols.default:n=parseInt(this.props.breakpointCols)||G,this.state={columnCount:n}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const a=window&&window.innerWidth||1/0;let n=this.props.breakpointCols;typeof n!="object"&&(n={default:parseInt(n)||G});let t=1/0,r=n.default||G;for(let l in n){const i=parseInt(l);i>0&&a<=i&&i<t&&(t=i,r=n[l])}r=Math.max(1,parseInt(r)||1),this.state.columnCount!==r&&this.setState({columnCount:r})}itemsInColumns(){const a=this.state.columnCount,n=new Array(a),t=W.Children.toArray(this.props.children);for(let r=0;r<t.length;r++){const l=r%a;n[l]||(n[l]=[]),n[l].push(t[r])}return n}renderColumns(){const{column:a,columnAttrs:n={},columnClassName:t}=this.props,r=this.itemsInColumns(),l=`${100/r.length}%`;let i=t;i&&typeof i!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof i=="undefined"&&(i="my-masonry-grid_column"));const d=B(B(B({},a),n),{},{style:B(B({},n.style),{},{width:l}),className:i});return r.map((c,b)=>W.createElement("div",H({},d,{key:b}),c))}logDeprecated(a){console.error("[Masonry]",a)}render(){const a=this.props,{children:n,breakpointCols:t,columnClassName:r,columnAttrs:l,column:i,className:d}=a,c=ce(a,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let b=d;return typeof d!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof d=="undefined"&&(b="my-masonry-grid")),W.createElement("div",H({},c,{className:b}),this.renderColumns())}}F.defaultProps=me;const Z={default:3,768:2};function V({images:e,isLoading:a,onImageSelect:n,categoryName:t}){return a?o.jsx(F,{breakpointCols:Z,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((r,l)=>o.jsx("div",{className:"gallery-thumbnail skeleton-item",children:o.jsx("div",{className:"skeleton-image",style:{height:`${200+l%3*50}px`}})},l))}):o.jsx(F,{breakpointCols:Z,className:"gallery-grid",columnClassName:"gallery-column",children:e.slice(0,6).map((r,l)=>o.jsx("div",{className:"gallery-thumbnail",onClick:()=>n(l),role:"button",tabIndex:0,"aria-label":`Öppna bild ${l+1} av ${e.length} i lightbox`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),n(l))},children:o.jsx("img",{src:r.thumbnail,alt:r.thumbnailAlt,loading:"eager"})},l))})}V.propTypes={images:u.arrayOf(u.shape({thumbnail:u.string,thumbnailAlt:u.string})).isRequired,isLoading:u.bool.isRequired,onImageSelect:u.func.isRequired,categoryName:u.string};V.defaultProps={categoryName:"Alla"};const pe={default:3,768:2};function X({images:e,startIndex:a,totalCount:n,onImageSelect:t,categoryName:r,buttonMode:l,onToggle:i,containerRef:d,buttonRef:c}){return o.jsxs("div",{className:"expanded-gallery-container",ref:d,children:[o.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),o.jsx(F,{breakpointCols:pe,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:e.map((b,g)=>{const v=g+a;return o.jsx("div",{className:"gallery-thumbnail",onClick:()=>t(v),role:"button",tabIndex:0,"aria-label":`Öppna bild ${v+1} av ${n} i lightbox`,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),t(v))},children:o.jsx("img",{src:b.thumbnail,alt:b.thumbnailAlt,loading:"lazy"})},v)})}),o.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),o.jsx("button",{ref:c,className:`hide-images-button ${l==="fixed"?"is-fixed":""} ${l==="bottom"?"at-bottom":""} ${l==="hidden"?"is-hidden":""}`,onClick:i,"aria-label":"Dölj utökade galleri bilder","aria-hidden":l==="hidden",children:"Dölj bilder"})]})}X.propTypes={images:u.arrayOf(u.shape({thumbnail:u.string,thumbnailAlt:u.string})).isRequired,startIndex:u.number,totalCount:u.number,onImageSelect:u.func.isRequired,categoryName:u.string,buttonMode:u.string.isRequired,onToggle:u.func.isRequired,containerRef:u.shape({current:u.any}),buttonRef:u.shape({current:u.any})};X.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function Y({isOpen:e,images:a,currentIndex:n,currentImage:t,onClose:r,onNext:l,onPrevious:i,onSelectImage:d,dialogRef:c,closeButtonRef:b,categories:g,activeCategory:v,onCategoryChange:k}){const[w,R]=s.useState(!1),[I,S]=s.useState(null),[j,p]=s.useState(null),f=s.useRef(null),N=s.useRef(null),y=50;s.useEffect(()=>{f.current&&(typeof c=="function"?c(f.current):c&&(c.current=f.current))},[c]),s.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),s.useEffect(()=>{if(!e)return;const m=C=>{switch(C.key){case"ArrowRight":l();break;case"ArrowLeft":i();break;case"Escape":r();break;case" ":C.preventDefault(),R(A=>!A);break}};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[e,l,i,r]);const h=m=>{p(null),S(m.targetTouches[0].clientX)},x=m=>{p(m.targetTouches[0].clientX)},E=()=>{if(!I||!j)return;const m=I-j,C=m>y,A=m<-y;C&&a.length>1?l():A&&a.length>1&&i()},T=m=>{m.stopPropagation(),R(C=>!C)};if(!e||!a||!t)return null;const D=n+1,P=a.length;return o.jsx("div",{className:`gallery-model ${w?"is-immersive":""}`,role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading",ref:f,onMouseDown:m=>{m.target===m.currentTarget&&r()},children:o.jsxs("div",{className:"gallery-model-content",children:[o.jsxs("div",{className:"sr-only",children:["Bildgalleri med ",P," bilder. Använd pilarna eller swipa för att navigera. Tryck på bilden för helskärm."]}),o.jsxs("div",{className:`lightbox-controls ${w?"is-hidden":""}`,children:[o.jsxs("div",{className:"lightbox-header-left",children:[o.jsxs("span",{className:"lightbox-counter",children:[D," / ",P]}),g&&k&&o.jsx("div",{className:"lightbox-categories desktop-only",children:g.map(m=>o.jsx("button",{className:`lightbox-category-btn ${v===m.id?"is-active":""}`,onClick:C=>{C.stopPropagation(),v!==m.id&&k(m.id)},children:m.name},m.id))})]}),o.jsx("button",{className:"gallery-close-button",onClick:r,"aria-label":"Stäng bildgalleri",ref:b,children:"×"})]}),o.jsxs("div",{className:"lightbox-stage",onTouchStart:h,onTouchMove:x,onTouchEnd:E,children:[a.length>1&&o.jsx("button",{type:"button",className:`lightbox-nav lightbox-nav--prev ${w?"is-hidden":""}`,onClick:m=>{m.stopPropagation(),i()},"aria-label":"Föregående bild",children:"‹"}),o.jsx("figure",{className:"lightbox-image-wrapper",children:o.jsx("img",{ref:N,src:t.original,alt:t.originalAlt||"Bild i galleriet",loading:"eager",onClick:T,className:"lightbox-image",style:{opacity:1}})}),a.length>1&&o.jsx("button",{type:"button",className:`lightbox-nav lightbox-nav--next ${w?"is-hidden":""}`,onClick:m=>{m.stopPropagation(),l()},"aria-label":"Nästa bild",children:"›"})]}),!w&&a.length>1&&o.jsxs("div",{className:"lightbox-footer",children:[g&&k&&o.jsx("div",{className:"lightbox-categories mobile-only",children:g.map(m=>o.jsx("button",{className:`lightbox-category-btn ${v===m.id?"is-active":""}`,onClick:C=>{C.stopPropagation(),v!==m.id&&k(m.id)},children:m.name},m.id))}),o.jsx("div",{className:"lightbox-thumbnails",role:"list",children:a.map((m,C)=>{var K;const A=C===n;return o.jsx("button",{type:"button",className:`lightbox-thumbnail ${A?"is-active":""}`,onClick:_=>{_.stopPropagation(),d(C)},"aria-label":`Gå till bild ${C+1}`,"aria-current":A||void 0,children:o.jsx("img",{src:m.thumbnail,alt:"",loading:"lazy"})},(K=m.filename)!=null?K:C)})}),o.jsx("p",{className:"lightbox-hint mobile-only",children:"Swipa för att bläddra • Tryck för helskärm"})]})]})})}Y.propTypes={isOpen:u.bool.isRequired,images:u.array.isRequired,currentIndex:u.number.isRequired,currentImage:u.object,onClose:u.func.isRequired,onNext:u.func.isRequired,onPrevious:u.func.isRequired,onSelectImage:u.func.isRequired,activeCategory:u.string,onCategoryChange:u.func,categories:u.array,dialogRef:u.any,closeButtonRef:u.any};const be={default:3,768:2};function re({images:e,onImageSelect:a}){return!e||e.length===0?null:o.jsxs("div",{className:"featured-gallery",children:[o.jsx(F,{breakpointCols:be,className:"gallery-grid",columnClassName:"gallery-column",children:e.map((n,t)=>{var r;return o.jsx("div",{className:"gallery-thumbnail",onClick:()=>a(t),role:"button",tabIndex:0,"aria-label":`Öppna utvald bild ${t+1} av ${e.length} i lightbox`,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),a(t))},children:o.jsx("img",{src:n.thumbnail,alt:n.thumbnailAlt,loading:"eager"})},(r=n.filename)!=null?r:t)})}),o.jsx("div",{className:"featured-divider","aria-hidden":"true"})]})}re.propTypes={images:u.arrayOf(u.shape({thumbnail:u.string,thumbnailAlt:u.string,description:u.string,filename:u.string})).isRequired,onImageSelect:u.func.isRequired};const fe=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),U=(e,a)=>{if(a===0)return 0;const n=e%a;return n<0?n+a:n};function ee(e,a){const[n,t]=s.useState(!1),[r,l]=s.useState(0),i=s.useRef(null),d=s.useRef(null),c=s.useRef(null),b=s.useRef(new Set),g=e.length>0,v=s.useCallback(p=>{g&&(c.current=document.activeElement,l(U(p,e.length)),t(!0))},[g,e.length]),k=s.useCallback(()=>{t(!1)},[]),w=s.useCallback(p=>{g&&l(U(p,e.length))},[g,e.length]),R=s.useCallback(()=>{g&&l(p=>(p+1)%e.length)},[g,e.length]),I=s.useCallback(()=>{g&&l(p=>(p-1+e.length)%e.length)},[g,e.length]);s.useEffect(()=>{if(!g){l(0);return}l(p=>p>=e.length?e.length-1:p<0?0:p)},[g,e.length]),s.useEffect(()=>{if(!n){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[n]),s.useEffect(()=>{if(n){const f=d.current;f&&f.focus({preventScroll:!0});return}const p=c.current;p&&typeof p.focus=="function"&&requestAnimationFrame(()=>{p.focus({preventScroll:!0}),c.current=null})},[n]),s.useEffect(()=>{if(!n)return;const p=f=>{f.key==="Escape"&&k()};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[n,k]),s.useEffect(()=>{if(!n||!g)return;const p=f=>{switch(f.key){case"ArrowRight":f.preventDefault(),R();break;case"ArrowLeft":f.preventDefault(),I();break;case"Home":f.preventDefault(),w(0);break;case"End":f.preventDefault(),w(e.length-1);break}};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[n,g,e.length,R,I,w]),s.useEffect(()=>{if(!n)return;const p=i.current;if(!p)return;const f=N=>{if(N.key!=="Tab")return;const y=Array.from(p.querySelectorAll(fe)).filter(D=>!D.hasAttribute("aria-hidden"));if(y.length===0){N.preventDefault();return}const h=y[0],x=y[y.length-1],E=N.shiftKey,T=document.activeElement;!E&&T===x?(N.preventDefault(),h.focus()):E&&T===h&&(N.preventDefault(),x.focus())};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[n]);const S=s.useCallback(p=>{if(!g)return;const f=U(p,e.length),N=e[f];if(!(N!=null&&N.original)||b.current.has(N.original))return;const y=new Image;y.src=N.original,b.current.add(N.original)},[g,e]);s.useEffect(()=>{b.current.clear(),l(0)},[a]),s.useEffect(()=>{!n||!g||(S(r),S(r+1),S(r-1))},[n,g,r,S]);const j=s.useMemo(()=>g?e[r]:null,[g,e,r]);return{isOpen:n,currentIndex:r,currentImage:j,openLightbox:v,closeLightbox:k,goToImage:w,goToNextImage:R,goToPreviousImage:I,dialogRef:i,closeButtonRef:d}}const q="hidden",ne="fixed",ae="bottom";function ye(e){const[a,n]=s.useState(q),t=s.useRef(null),r=s.useRef(null),l=s.useRef(q),i=s.useCallback(d=>{l.current!==d&&(l.current=d,n(d))},[]);return s.useEffect(()=>{if(!e){i(q);return}const d=t.current;if(!d)return;let c=!1;const b=8,g=d.querySelector(".sentinel-top"),v=d.querySelector(".sentinel-bottom");let k=!1,w=!1,R,I;const S=y=>{let h=0,x=y;for(;x;)h+=x.offsetTop||0,x=x.offsetParent;return h},j=()=>{const y=t.current;if(!y)return;const h=S(y),x=y.offsetHeight,E=h+x,T=window.scrollY||window.pageYOffset,D=window.innerHeight||document.documentElement.clientHeight,P=T+D;if(P<h){i(q);return}if(T>=E){i(q);return}if(P>=E-b){i(ae);return}i(ne)},p=()=>{c||(c=!0,requestAnimationFrame(()=>{j(),c=!1}))},f=()=>{j()};return"IntersectionObserver"in window&&g&&v&&(I=new IntersectionObserver(y=>{if(y.forEach(h=>{h.target===g&&(k=h.isIntersecting),h.target===v&&(w=h.isIntersecting)}),!k&&!w){const h=S(d),x=h+d.offsetHeight,E=window.scrollY||window.pageYOffset;if(E+(window.innerHeight||document.documentElement.clientHeight)<h||E>=x){i(q);return}}w?i(ae):k&&i(ne)},{root:null,threshold:0}),I.observe(g),I.observe(v)),window.ResizeObserver&&(R=new ResizeObserver(()=>j()),R.observe(d)),d.querySelectorAll("img").forEach(y=>{y.complete||y.addEventListener("load",j,{once:!0})}),setTimeout(j,50),setTimeout(j,200),setTimeout(j,600),j(),window.addEventListener("scroll",p,{passive:!0}),window.addEventListener("resize",f),()=>{window.removeEventListener("scroll",p),window.removeEventListener("resize",f),R&&R.disconnect(),I&&I.disconnect()}},[e,i]),{mode:a,containerRef:t,buttonRef:r}}function ve(){const[e,a]=s.useState("alla"),[n,t]=s.useState(!1),[r,l]=s.useState(!1),i=s.useMemo(()=>z.categories.find(L=>L.id===e),[e]),d=s.useMemo(()=>i!=null&&i.images?i.images.map(L=>({original:L.path,thumbnail:L.path,description:L.displayName,originalAlt:L.displayName,thumbnailAlt:L.displayName,filename:L.filename,subcategory:L.subcategory})):[],[i]),c=s.useMemo(()=>{if(!($!=null&&$.featured)||$.featured.length===0)return[];const L=z.categories.find(M=>M.id==="alla");return L?$.featured.map(M=>{const O=L.images.find(oe=>oe.filename===M);return O?{original:O.path,thumbnail:O.path,description:O.displayName,originalAlt:O.displayName,thumbnailAlt:O.displayName,filename:O.filename,subcategory:O.subcategory}:null}).filter(Boolean):[]},[]),{isOpen:b,currentIndex:g,currentImage:v,openLightbox:k,closeLightbox:w,goToImage:R,goToNextImage:I,goToPreviousImage:S,dialogRef:j,closeButtonRef:p}=ee(c,"featured"),{isOpen:f,currentIndex:N,currentImage:y,openLightbox:h,closeLightbox:x,goToImage:E,goToNextImage:T,goToPreviousImage:D,dialogRef:P,closeButtonRef:m}=ee(d,e),{mode:C,containerRef:A,buttonRef:K}=ye(r),_=s.useCallback(()=>{l(L=>!L)},[]),le=s.useCallback(L=>{t(!0),a(L),l(!1),x(),setTimeout(()=>{t(!1)},300)},[x]),J=(i==null?void 0:i.name)||"Alla";return o.jsxs("div",{className:"storegarden-gallery",children:[o.jsx("div",{className:"gallery-logo-container",children:o.jsx("img",{src:ie,alt:"Storegården 7",className:"gallery-logo"})}),o.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),c.length>0&&o.jsx(re,{images:c,onImageSelect:k}),o.jsx(te,{categories:z.categories,activeCategory:e,onCategoryChange:le}),o.jsx(V,{images:d,isLoading:n,onImageSelect:h,categoryName:J}),!r&&o.jsxs("button",{className:"show-more-button",onClick:_,"aria-expanded":r,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${d.length} bilder i galleriet`,children:["Visa alla bilder (",d.length,")"]}),r&&o.jsx(X,{images:d.slice(6),startIndex:6,totalCount:d.length,onImageSelect:h,categoryName:J,buttonMode:C,onToggle:_,containerRef:A,buttonRef:K}),o.jsx(Y,{isOpen:b,images:c,currentIndex:g,currentImage:v,onClose:w,onNext:I,onPrevious:S,onSelectImage:R,dialogRef:j,closeButtonRef:p}),o.jsx(Y,{isOpen:f,images:d,currentIndex:N,currentImage:y,onClose:x,onNext:T,onPrevious:D,onSelectImage:E,dialogRef:P,closeButtonRef:m,categories:z.categories,activeCategory:e,onCategoryChange:a})]})}export{ve as default};
