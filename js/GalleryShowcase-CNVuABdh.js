import{j as o,P as t,l as oe}from"./index-BRNB2P1z.js";import{b as u,e as P}from"./vendor-ASO3vaGF.js";function Z({categories:n,activeCategory:r,onCategoryChange:e}){const[a,l]=u.useState(0),i=u.useRef(null),s=u.useRef([]);u.useEffect(()=>{const d=n.findIndex(p=>p.id===r);d!==-1&&l(d)},[r,n]),u.useEffect(()=>{if(s.current[a]&&i.current){const d=s.current[a],p=i.current;if(p.scrollWidth>p.clientWidth){const c=d.offsetLeft,f=d.offsetWidth,v=p.clientWidth,w=c-v/2+f/2;p.scrollTo({left:w,behavior:"smooth"})}}},[a]);const g=(d,p)=>{l(p),e(d.id)};return o.jsx("div",{className:"category-toggle",children:o.jsx("div",{className:"category-toggle-container",ref:i,children:n.map((d,p)=>o.jsxs("button",{ref:c=>s.current[p]=c,className:`category-button ${p===a?"active":""}`,onClick:()=>g(d,p),"aria-label":`Visa ${d.name} (${d.images.length} bilder)`,children:[o.jsx("span",{className:"category-name",children:d.name}),o.jsxs("span",{className:"category-count",children:["(",d.images.length,")"]})]},d.id))})})}Z.propTypes={categories:t.arrayOf(t.shape({id:t.string.isRequired,name:t.string.isRequired,images:t.array.isRequired})).isRequired,activeCategory:t.string.isRequired,onCategoryChange:t.func.isRequired};const se=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Övervåning - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Övervåning - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Övervåning - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Övervåning - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Övervåning - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Undervåning - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Undervåning - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Undervåning - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Undervåning - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Undervåning - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Undervåning - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Undervåning - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Undervåning - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Undervåning - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Undervåning - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Undervåning - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Undervåning - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Undervåning - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Undervåning - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Undervåning - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Undervåning - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Undervåning - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Undervåning - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Ute - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Ute - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Ute - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]},{id:"undervaning",name:"Undervåning",description:"Nedre våningen, kök och serviceområden",images:[{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Undervåning - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Undervåning - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Undervåning - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Undervåning - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Undervåning - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Undervåning - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Undervåning - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Undervåning - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Undervåning - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Undervåning - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Undervåning - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Undervåning - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Undervåning - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Undervåning - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Undervåning - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Undervåning - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Undervåning - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Undervåning - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"}]},{id:"overvaning",name:"Övervåning",description:"Övre våningen på Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Övervåning - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Övervåning - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Övervåning - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Övervåning - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Övervåning - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"}]},{id:"ute",name:"Ute",description:"Utemiljö och toaletter",images:[{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Ute - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Ute - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Ute - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]}],K={categories:se},ue=["lokal-upper-1.webp","lokal-upper-5.webp","lokal-under-1.webp","lokal-under-10.webp","lokal-under-11.webp","lokal-service-3.webp","lokal-ute-1.webp"],T={featured:ue};function ce(n,r){if(n==null)return{};var e=ge(n,r),a,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(l=0;l<i.length;l++)a=i[l],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(n,a)&&(e[a]=n[a])}return e}function ge(n,r){if(n==null)return{};var e={},a=Object.keys(n),l,i;for(i=0;i<a.length;i++)l=a[i],!(r.indexOf(l)>=0)&&(e[l]=n[l]);return e}function B(){return B=Object.assign||function(n){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},B.apply(this,arguments)}function Y(n,r){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),e.push.apply(e,a)}return e}function L(n){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Y(Object(e),!0).forEach(function(a){de(n,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Y(Object(e)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(e,a))})}return n}function de(n,r,e){return r in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}const me={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},z=2;class q extends P.Component{constructor(r){super(r),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||z,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const r=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||z});let a=1/0,l=e.default||z;for(let i in e){const s=parseInt(i);s>0&&r<=s&&s<a&&(a=s,l=e[i])}l=Math.max(1,parseInt(l)||1),this.state.columnCount!==l&&this.setState({columnCount:l})}itemsInColumns(){const r=this.state.columnCount,e=new Array(r),a=P.Children.toArray(this.props.children);for(let l=0;l<a.length;l++){const i=l%r;e[i]||(e[i]=[]),e[i].push(a[l])}return e}renderColumns(){const{column:r,columnAttrs:e={},columnClassName:a}=this.props,l=this.itemsInColumns(),i=`${100/l.length}%`;let s=a;s&&typeof s!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof s=="undefined"&&(s="my-masonry-grid_column"));const g=L(L(L({},r),e),{},{style:L(L({},e.style),{},{width:i}),className:s});return l.map((d,p)=>P.createElement("div",B({},g,{key:p}),d))}logDeprecated(r){console.error("[Masonry]",r)}render(){const r=this.props,{children:e,breakpointCols:a,columnClassName:l,columnAttrs:i,column:s,className:g}=r,d=ce(r,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let p=g;return typeof g!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof g=="undefined"&&(p="my-masonry-grid")),P.createElement("div",B({},d,{className:p}),this.renderColumns())}}q.defaultProps=me;const V={default:3,768:2};function W({images:n,isLoading:r,onImageSelect:e,categoryName:a}){return r?o.jsx(q,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((l,i)=>o.jsx("div",{className:"gallery-thumbnail skeleton-item",children:o.jsx("div",{className:"skeleton-image",style:{height:`${200+i%3*50}px`}})},i))}):o.jsx(q,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:n.slice(0,6).map((l,i)=>o.jsx("div",{className:"gallery-thumbnail",onClick:()=>e(i),role:"button",tabIndex:0,"aria-label":`Öppna bild ${i+1} av ${n.length} i lightbox`,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e(i))},children:o.jsx("img",{src:l.thumbnail,alt:l.thumbnailAlt,loading:"eager"})},i))})}W.propTypes={images:t.arrayOf(t.shape({thumbnail:t.string,thumbnailAlt:t.string})).isRequired,isLoading:t.bool.isRequired,onImageSelect:t.func.isRequired,categoryName:t.string};W.defaultProps={categoryName:"Alla"};const pe={default:3,768:2};function _({images:n,startIndex:r,totalCount:e,onImageSelect:a,categoryName:l,buttonMode:i,onToggle:s,containerRef:g,buttonRef:d}){return o.jsxs("div",{className:"expanded-gallery-container",ref:g,children:[o.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),o.jsx(q,{breakpointCols:pe,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:n.map((p,c)=>{const f=c+r;return o.jsx("div",{className:"gallery-thumbnail",onClick:()=>a(f),role:"button",tabIndex:0,"aria-label":`Öppna bild ${f+1} av ${e} i lightbox`,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),a(f))},children:o.jsx("img",{src:p.thumbnail,alt:p.thumbnailAlt,loading:"lazy"})},f)})}),o.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),o.jsx("button",{ref:d,className:`hide-images-button ${i==="fixed"?"is-fixed":""} ${i==="bottom"?"at-bottom":""} ${i==="hidden"?"is-hidden":""}`,onClick:s,"aria-label":"Dölj utökade galleri bilder","aria-hidden":i==="hidden",children:"Dölj bilder"})]})}_.propTypes={images:t.arrayOf(t.shape({thumbnail:t.string,thumbnailAlt:t.string})).isRequired,startIndex:t.number,totalCount:t.number,onImageSelect:t.func.isRequired,categoryName:t.string,buttonMode:t.string.isRequired,onToggle:t.func.isRequired,containerRef:t.shape({current:t.any}),buttonRef:t.shape({current:t.any})};_.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function $({isOpen:n,images:r,currentIndex:e,currentImage:a,onClose:l,onNext:i,onPrevious:s,onSelectImage:g,dialogRef:d,closeButtonRef:p}){return n?o.jsx("div",{className:"gallery-model",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",ref:d,onMouseDown:c=>{c.target===c.currentTarget&&l()},children:o.jsxs("div",{className:"gallery-model-content",children:[o.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",r.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),o.jsx("button",{className:"gallery-close-button",onClick:l,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",ref:p,type:"button",children:"×"}),a?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"lightbox-stage",children:[r.length>1&&o.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--prev",onClick:s,"aria-label":"Visa föregående bild",children:"‹"}),o.jsx("figure",{className:"lightbox-image-wrapper",children:o.jsx("img",{src:a.original,alt:a.originalAlt||a.description||"Bild i galleriet",loading:"eager"})}),r.length>1&&o.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--next",onClick:i,"aria-label":"Visa nästa bild",children:"›"})]}),o.jsxs("div",{className:"lightbox-footer",children:[o.jsxs("span",{className:"lightbox-counter","aria-live":"polite",children:[e+1," / ",r.length]}),r.length>1&&o.jsx("div",{className:"lightbox-thumbnails",role:"list",children:r.map((c,f)=>{var w;const v=f===e;return o.jsx("button",{type:"button",className:`lightbox-thumbnail ${v?"is-active":""}`,onClick:()=>g(f),"aria-label":`Gå till bild ${f+1} av ${r.length}`,"aria-current":v?"true":void 0,children:o.jsx("img",{src:c.thumbnail,alt:c.thumbnailAlt,loading:"lazy"})},(w=c.filename)!=null?w:f)})})]})]}):o.jsx("div",{className:"lightbox-empty",children:o.jsx("p",{children:"Inga bilder tillgängliga i denna kategori."})})]})}):null}$.propTypes={isOpen:t.bool.isRequired,images:t.arrayOf(t.shape({original:t.string,originalAlt:t.string,description:t.string,thumbnail:t.string,thumbnailAlt:t.string,filename:t.string})).isRequired,currentIndex:t.number.isRequired,currentImage:t.shape({original:t.string,originalAlt:t.string,description:t.string}),onClose:t.func.isRequired,onNext:t.func.isRequired,onPrevious:t.func.isRequired,onSelectImage:t.func.isRequired,dialogRef:t.shape({current:t.any}).isRequired,closeButtonRef:t.shape({current:t.any}).isRequired};$.defaultProps={currentImage:null};const be={default:3,768:2};function ee({images:n,onImageSelect:r}){return!n||n.length===0?null:o.jsxs("div",{className:"featured-gallery",children:[o.jsx(q,{breakpointCols:be,className:"gallery-grid",columnClassName:"gallery-column",children:n.map((e,a)=>{var l;return o.jsx("div",{className:"gallery-thumbnail",onClick:()=>r(a),role:"button",tabIndex:0,"aria-label":`Öppna utvald bild ${a+1} av ${n.length} i lightbox`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),r(a))},children:o.jsx("img",{src:e.thumbnail,alt:e.thumbnailAlt,loading:"eager"})},(l=e.filename)!=null?l:a)})}),o.jsx("div",{className:"featured-divider","aria-hidden":"true"})]})}ee.propTypes={images:t.arrayOf(t.shape({thumbnail:t.string,thumbnailAlt:t.string,description:t.string,filename:t.string})).isRequired,onImageSelect:t.func.isRequired};const fe=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),H=(n,r)=>{if(r===0)return 0;const e=n%r;return e<0?e+r:e};function X(n,r){const[e,a]=u.useState(!1),[l,i]=u.useState(0),s=u.useRef(null),g=u.useRef(null),d=u.useRef(null),p=u.useRef(new Set),c=n.length>0,f=u.useCallback(m=>{c&&(d.current=document.activeElement,i(H(m,n.length)),a(!0))},[c,n.length]),v=u.useCallback(()=>{a(!1)},[]),w=u.useCallback(m=>{c&&i(H(m,n.length))},[c,n.length]),I=u.useCallback(()=>{c&&i(m=>(m+1)%n.length)},[c,n.length]),j=u.useCallback(()=>{c&&i(m=>(m-1+n.length)%n.length)},[c,n.length]);u.useEffect(()=>{if(!c){i(0);return}i(m=>m>=n.length?n.length-1:m<0?0:m)},[c,n.length]),u.useEffect(()=>{if(!e){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[e]),u.useEffect(()=>{if(e){const b=g.current;b&&b.focus({preventScroll:!0});return}const m=d.current;m&&typeof m.focus=="function"&&requestAnimationFrame(()=>{m.focus({preventScroll:!0}),d.current=null})},[e]),u.useEffect(()=>{if(!e)return;const m=b=>{b.key==="Escape"&&v()};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,v]),u.useEffect(()=>{if(!e||!c)return;const m=b=>{switch(b.key){case"ArrowRight":b.preventDefault(),I();break;case"ArrowLeft":b.preventDefault(),j();break;case"Home":b.preventDefault(),w(0);break;case"End":b.preventDefault(),w(n.length-1);break}};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,c,n.length,I,j,w]),u.useEffect(()=>{if(!e)return;const m=s.current;if(!m)return;const b=N=>{if(N.key!=="Tab")return;const y=Array.from(m.querySelectorAll(fe)).filter(U=>!U.hasAttribute("aria-hidden"));if(y.length===0){N.preventDefault();return}const h=y[0],x=y[y.length-1],R=N.shiftKey,O=document.activeElement;!R&&O===x?(N.preventDefault(),h.focus()):R&&O===h&&(N.preventDefault(),x.focus())};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[e]);const E=u.useCallback(m=>{if(!c)return;const b=H(m,n.length),N=n[b];if(!(N!=null&&N.original)||p.current.has(N.original))return;const y=new Image;y.src=N.original,p.current.add(N.original)},[c,n]);u.useEffect(()=>{p.current.clear()},[r]),u.useEffect(()=>{!e||!c||(E(l),E(l+1),E(l-1))},[e,c,l,E]);const C=u.useMemo(()=>c?n[l]:null,[c,n,l]);return{isOpen:e,currentIndex:l,currentImage:C,openLightbox:f,closeLightbox:v,goToImage:w,goToNextImage:I,goToPreviousImage:j,dialogRef:s,closeButtonRef:g}}const S="hidden",J="fixed",Q="bottom";function ye(n){const[r,e]=u.useState(S),a=u.useRef(null),l=u.useRef(null),i=u.useRef(S),s=u.useCallback(g=>{i.current!==g&&(i.current=g,e(g))},[]);return u.useEffect(()=>{if(!n){s(S);return}const g=a.current;if(!g)return;let d=!1;const p=8,c=g.querySelector(".sentinel-top"),f=g.querySelector(".sentinel-bottom");let v=!1,w=!1,I,j;const E=y=>{let h=0,x=y;for(;x;)h+=x.offsetTop||0,x=x.offsetParent;return h},C=()=>{const y=a.current;if(!y)return;const h=E(y),x=y.offsetHeight,R=h+x,O=window.scrollY||window.pageYOffset,U=window.innerHeight||document.documentElement.clientHeight,D=O+U;if(D<h){s(S);return}if(O>=R){s(S);return}if(D>=R-p){s(Q);return}s(J)},m=()=>{d||(d=!0,requestAnimationFrame(()=>{C(),d=!1}))},b=()=>{C()};return"IntersectionObserver"in window&&c&&f&&(j=new IntersectionObserver(y=>{if(y.forEach(h=>{h.target===c&&(v=h.isIntersecting),h.target===f&&(w=h.isIntersecting)}),!v&&!w){const h=E(g),x=h+g.offsetHeight,R=window.scrollY||window.pageYOffset;if(R+(window.innerHeight||document.documentElement.clientHeight)<h||R>=x){s(S);return}}w?s(Q):v&&s(J)},{root:null,threshold:0}),j.observe(c),j.observe(f)),window.ResizeObserver&&(I=new ResizeObserver(()=>C()),I.observe(g)),g.querySelectorAll("img").forEach(y=>{y.complete||y.addEventListener("load",C,{once:!0})}),setTimeout(C,50),setTimeout(C,200),setTimeout(C,600),C(),window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",b),()=>{window.removeEventListener("scroll",m),window.removeEventListener("resize",b),I&&I.disconnect(),j&&j.disconnect()}},[n,s]),{mode:r,containerRef:a,buttonRef:l}}function ke(){const[n,r]=u.useState("alla"),[e,a]=u.useState(!1),[l,i]=u.useState(!1),s=u.useMemo(()=>K.categories.find(k=>k.id===n),[n]),g=u.useMemo(()=>s!=null&&s.images?s.images.map(k=>({original:k.path,thumbnail:k.path,description:k.displayName,originalAlt:k.displayName,thumbnailAlt:k.displayName,filename:k.filename,subcategory:k.subcategory})):[],[s]),d=u.useMemo(()=>{if(!(T!=null&&T.featured)||T.featured.length===0)return[];const k=K.categories.find(F=>F.id==="alla");return k?T.featured.map(F=>{const A=k.images.find(ie=>ie.filename===F);return A?{original:A.path,thumbnail:A.path,description:A.displayName,originalAlt:A.displayName,thumbnailAlt:A.displayName,filename:A.filename,subcategory:A.subcategory}:null}).filter(Boolean):[]},[]),{isOpen:p,currentIndex:c,currentImage:f,openLightbox:v,closeLightbox:w,goToImage:I,goToNextImage:j,goToPreviousImage:E,dialogRef:C,closeButtonRef:m}=X(d,"featured"),{isOpen:b,currentIndex:N,currentImage:y,openLightbox:h,closeLightbox:x,goToImage:R,goToNextImage:O,goToPreviousImage:U,dialogRef:D,closeButtonRef:ne}=X(g,n),{mode:re,containerRef:ae,buttonRef:te}=ye(l),M=u.useCallback(()=>{i(k=>!k)},[]),le=u.useCallback(k=>{a(!0),r(k),i(!1),x(),setTimeout(()=>{a(!1)},300)},[x]),G=(s==null?void 0:s.name)||"Alla";return o.jsxs("div",{className:"storegarden-gallery",children:[o.jsx("div",{className:"gallery-logo-container",children:o.jsx("img",{src:oe,alt:"Storegården 7",className:"gallery-logo"})}),o.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),d.length>0&&o.jsx(ee,{images:d,onImageSelect:v}),o.jsx(Z,{categories:K.categories,activeCategory:n,onCategoryChange:le}),o.jsx(W,{images:g,isLoading:e,onImageSelect:h,categoryName:G}),!l&&o.jsxs("button",{className:"show-more-button",onClick:M,"aria-expanded":l,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${g.length} bilder i galleriet`,children:["Visa alla bilder (",g.length,")"]}),l&&o.jsx(_,{images:g.slice(6),startIndex:6,totalCount:g.length,onImageSelect:h,categoryName:G,buttonMode:re,onToggle:M,containerRef:ae,buttonRef:te}),o.jsx($,{isOpen:p,images:d,currentIndex:c,currentImage:f,onClose:w,onNext:j,onPrevious:E,onSelectImage:I,dialogRef:C,closeButtonRef:m}),o.jsx($,{isOpen:b,images:g,currentIndex:N,currentImage:y,onClose:x,onNext:O,onPrevious:U,onSelectImage:R,dialogRef:D,closeButtonRef:ne})]})}export{ke as default};
