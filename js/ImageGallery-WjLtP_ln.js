import{j as s}from"./index-r0JYliSj.js";import{R as w,r as g}from"./vendor-DaLL37dA.js";import{c as E}from"./gallery-BsZh0IYC.js";function L(t,n){if(t==null)return{};var e=B(t,n),l,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(a=0;a<c.length;a++)l=c[a],!(n.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(e[l]=t[l])}return e}function B(t,n){if(t==null)return{};var e={},l=Object.keys(t),a,c;for(c=0;c<l.length;c++)a=l[c],!(n.indexOf(a)>=0)&&(e[a]=t[a]);return e}function v(){return v=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l])}return t},v.apply(this,arguments)}function D(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);n&&(l=l.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,l)}return e}function y(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?D(Object(e),!0).forEach(function(l){W(t,l,e[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):D(Object(e)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(e,l))})}return t}function W(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}const R={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},I=2;class k extends w.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||I,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||I});let l=1/0,a=e.default||I;for(let c in e){const o=parseInt(c);o>0&&n<=o&&o<l&&(l=o,a=e[c])}a=Math.max(1,parseInt(a)||1),this.state.columnCount!==a&&this.setState({columnCount:a})}itemsInColumns(){const n=this.state.columnCount,e=new Array(n),l=w.Children.toArray(this.props.children);for(let a=0;a<l.length;a++){const c=a%n;e[c]||(e[c]=[]),e[c].push(l[a])}return e}renderColumns(){const{column:n,columnAttrs:e={},columnClassName:l}=this.props,a=this.itemsInColumns(),c=`${100/a.length}%`;let o=l;o&&typeof o!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof o=="undefined"&&(o="my-masonry-grid_column"));const h=y(y(y({},n),e),{},{style:y(y({},e.style),{},{width:c}),className:o});return a.map((u,d)=>w.createElement("div",v({},h,{key:d}),u))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:e,breakpointCols:l,columnClassName:a,columnAttrs:c,column:o,className:h}=n,u=L(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let d=h;return typeof h!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof h=="undefined"&&(d="my-masonry-grid")),w.createElement("div",v({},u,{className:d}),this.renderColumns())}}k.defaultProps=R;function _({categories:t,activeCategory:n,onCategoryChange:e}){const[l,a]=g.useState(0),c=g.useRef(null),o=g.useRef([]);g.useEffect(()=>{const u=t.findIndex(d=>d.id===n);u!==-1&&a(u)},[n,t]),g.useEffect(()=>{if(o.current[l]&&c.current){const u=o.current[l],d=c.current;if(d.scrollWidth>d.clientWidth){const b=u.offsetLeft,N=u.offsetWidth,O=d.clientWidth,j=b-O/2+N/2;d.scrollTo({left:j,behavior:"smooth"})}}},[l]);const h=(u,d)=>{a(d),e(u.id)};return s.jsx("div",{className:"category-toggle",children:s.jsx("div",{className:"category-toggle-container",ref:c,children:t.map((u,d)=>s.jsxs("button",{ref:b=>o.current[d]=b,className:`category-button ${d===l?"active":""}`,onClick:()=>h(u,d),"aria-label":`Visa ${u.name} (${u.images.length} bilder)`,children:[s.jsx("span",{className:"category-name",children:u.name}),s.jsxs("span",{className:"category-count",children:["(",u.images.length,")"]})]},u.id))})})}const z=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{id:"evenemang",name:"Evenemang",description:"Evenemang från Storegården 7",images:[2,4,6,8,10,12,14]},{id:"konst-keramik",name:"Konst & Keramik",description:"Konst och keramik från Storegården 7",images:[16,18,19,20]},{id:"lokal",name:"Lokal",description:"Lokal bilder från Storegården 7",images:[1,3,5,7,9,11,13,15,17]}],C={categories:z};function K(){const[t,n]=g.useState("alla"),[e,l]=g.useState(!1),a=(m,r)=>{if(r==="alla"){for(const p of C.categories)if(p.id!=="alla"&&p.images.includes(m))return`/images/${p.id}/slide${m}.jpg`;return`/images/slides/slide${m}.jpg`}return`/images/${r}/slide${m}.jpg`},c=g.useMemo(()=>{const m=i=>{const f=["small","medium","small","small","large","small","medium","small","small","medium","small","large","small","small","medium","small","small","large","medium","small"];return f[i%f.length]},r=new Set;return C.categories.forEach(i=>{i.id!=="alla"&&i.images.forEach(f=>r.add(f))}),Array.from(r).sort((i,f)=>i-f).map((i,f)=>({original:a(i,"alla"),thumbnail:a(i,"alla"),description:`Bild ${i} från Storegården 7`,originalAlt:`Bild ${i}`,thumbnailAlt:`Miniatyr ${i}`,sizeClass:m(f),imageNumber:i}))},[]),o=g.useMemo(()=>{const m=C.categories.find(r=>r.id===t);return!m||t==="alla"?c:m.images.map((r,p)=>{const i=f=>{const S=["small","medium","small","small","large","small","medium","small","small","medium","small","large","small","small","medium","small","small","large","medium","small"];return S[f%S.length]};return{original:a(r,t),thumbnail:a(r,t),description:`Bild ${r} från Storegården 7`,originalAlt:`Bild ${r}`,thumbnailAlt:`Miniatyr ${r}`,sizeClass:i(p),imageNumber:r}})},[t]),[h,u]=g.useState(!1),[d,b]=g.useState(!1),[N,O]=g.useState(0),j=g.useCallback(()=>{u(!h)},[h]),x=g.useCallback(m=>{O(m),b(!0)},[]),$=g.useCallback(m=>{l(!0),n(m),u(!1),b(!1),setTimeout(()=>{l(!1)},300)},[]),P=g.useCallback(()=>{b(!1)},[]),A={default:3,768:2,480:1};return s.jsxs("div",{className:"storegarden-gallery",children:[s.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),s.jsx(_,{categories:C.categories,activeCategory:t,onCategoryChange:$}),e?s.jsx(k,{breakpointCols:A,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((m,r)=>s.jsx("div",{className:"gallery-thumbnail skeleton-item",children:s.jsx("div",{className:"skeleton-image",style:{height:`${200+r%3*50}px`}})},r))}):s.jsx(k,{breakpointCols:A,className:"gallery-grid",columnClassName:"gallery-column",children:o.slice(0,6).map((m,r)=>{var p;return s.jsxs("div",{className:"gallery-thumbnail",onClick:()=>x(r),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+1} av ${o.length} i lightbox`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),x(r))},children:[s.jsx("img",{src:m.thumbnail,alt:m.thumbnailAlt,loading:"eager"}),s.jsxs("div",{className:"image-overlay",children:[s.jsx("span",{className:"image-category",children:((p=C.categories.find(i=>i.id===t))==null?void 0:p.name)||"Alla"}),s.jsxs("span",{className:"image-number",children:["#",m.imageNumber]})]})]},r)})}),!h&&s.jsxs("button",{className:"show-more-button",onClick:j,"aria-expanded":h,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${o.length} bilder i galleriet`,children:["Visa alla bilder (",o.length,")"]}),h&&s.jsxs(s.Fragment,{children:[s.jsx(k,{breakpointCols:A,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:o.slice(6).map((m,r)=>{var p;return s.jsxs("div",{className:"gallery-thumbnail",onClick:()=>x(r+6),role:"button",tabIndex:0,"aria-label":`Öppna bild ${r+7} av ${o.length} i lightbox`,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),x(r+6))},children:[s.jsx("img",{src:m.thumbnail,alt:m.thumbnailAlt,loading:"lazy"}),s.jsxs("div",{className:"image-overlay",children:[s.jsx("span",{className:"image-category",children:((p=C.categories.find(i=>i.id===t))==null?void 0:p.name)||"Alla"}),s.jsxs("span",{className:"image-number",children:["#",m.imageNumber]})]})]},r+6)})}),s.jsx("button",{className:"hide-images-button",onClick:j,"aria-label":"Dölj utökade galleri bilder",children:"Dölj bilder"})]}),d&&s.jsx("div",{className:"gallery-modal",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",children:s.jsxs("div",{className:"gallery-modal-content",children:[s.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",o.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),s.jsx("button",{className:"gallery-close-button",onClick:P,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",children:"×"}),s.jsx(E,{items:o,startIndex:N,showThumbnails:!0,showFullscreenButton:!0,showPlayButton:!1,showIndex:!0,showBullets:!1,infinite:!0,slideDuration:300,slideInterval:2e3})]})})]})}export{K as default};
