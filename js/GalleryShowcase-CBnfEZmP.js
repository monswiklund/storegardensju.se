import{j as i,P as r,l as ie}from"./index-DB-KZX3R.js";import{b as u,h as B}from"./vendor-kgT0sz4b.js";function Z({categories:n,activeCategory:a,onCategoryChange:e}){const[t,l]=u.useState(0),o=u.useRef(null),s=u.useRef([]);u.useEffect(()=>{const g=n.findIndex(p=>p.id===a);g!==-1&&l(g)},[a,n]),u.useEffect(()=>{if(s.current[t]&&o.current){const g=s.current[t],p=o.current;if(p.scrollWidth>p.clientWidth){const c=g.offsetLeft,f=g.offsetWidth,k=p.clientWidth,w=c-k/2+f/2;p.scrollTo({left:w,behavior:"smooth"})}}},[t]);const d=(g,p)=>{l(p),e(g.id)};return i.jsx("div",{className:"category-toggle",children:i.jsx("div",{className:"category-toggle-container",ref:o,children:n.map((g,p)=>i.jsxs("button",{ref:c=>s.current[p]=c,className:`category-button ${p===t?"active":""}`,onClick:()=>d(g,p),"aria-label":`Visa ${g.name} (${g.images.length} bilder)`,children:[i.jsx("span",{className:"category-name",children:g.name}),i.jsxs("span",{className:"category-count",children:["(",g.images.length,")"]})]},g.id))})})}Z.propTypes={categories:r.arrayOf(r.shape({id:r.string.isRequired,name:r.string.isRequired,images:r.array.isRequired})).isRequired,activeCategory:r.string.isRequired,onCategoryChange:r.func.isRequired};const se=[{id:"alla",name:"Alla bilder",description:"Alla bilder från Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Loftet - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Loftet - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Loftet - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Loftet - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Loftet - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"},{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Ladan - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Ladan - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Ladan - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Ladan - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Ladan - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Ladan - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Ladan - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Ladan - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Ladan - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Ladan - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Ladan - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Ladan - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Ladan - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Ladan - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Ladan - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Ladan - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Ladan - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Ladan - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"},{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Övrigt - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Övrigt - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Övrigt - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]},{id:"undervaning",name:"Ladan",description:"Nedre våningen, kök och serviceområden",images:[{filename:"lokal-under-1.webp",category:"undervaning",subcategory:"under",number:1,displayName:"Ladan - Nedre våning 1",path:"/images/gallery/lokal-under-1.webp"},{filename:"lokal-under-2.webp",category:"undervaning",subcategory:"under",number:2,displayName:"Ladan - Nedre våning 2",path:"/images/gallery/lokal-under-2.webp"},{filename:"lokal-under-3.webp",category:"undervaning",subcategory:"under",number:3,displayName:"Ladan - Nedre våning 3",path:"/images/gallery/lokal-under-3.webp"},{filename:"lokal-under-4.webp",category:"undervaning",subcategory:"under",number:4,displayName:"Ladan - Nedre våning 4",path:"/images/gallery/lokal-under-4.webp"},{filename:"lokal-under-5.webp",category:"undervaning",subcategory:"under",number:5,displayName:"Ladan - Nedre våning 5",path:"/images/gallery/lokal-under-5.webp"},{filename:"lokal-under-6.webp",category:"undervaning",subcategory:"under",number:6,displayName:"Ladan - Nedre våning 6",path:"/images/gallery/lokal-under-6.webp"},{filename:"lokal-under-7.webp",category:"undervaning",subcategory:"under",number:7,displayName:"Ladan - Nedre våning 7",path:"/images/gallery/lokal-under-7.webp"},{filename:"lokal-under-8.webp",category:"undervaning",subcategory:"under",number:8,displayName:"Ladan - Nedre våning 8",path:"/images/gallery/lokal-under-8.webp"},{filename:"lokal-under-9.webp",category:"undervaning",subcategory:"under",number:9,displayName:"Ladan - Nedre våning 9",path:"/images/gallery/lokal-under-9.webp"},{filename:"lokal-under-10.webp",category:"undervaning",subcategory:"under",number:10,displayName:"Ladan - Nedre våning 10",path:"/images/gallery/lokal-under-10.webp"},{filename:"lokal-under-11.webp",category:"undervaning",subcategory:"under",number:11,displayName:"Ladan - Nedre våning 11",path:"/images/gallery/lokal-under-11.webp"},{filename:"lokal-kok-1.webp",category:"undervaning",subcategory:"kok",number:1,displayName:"Ladan - Kök 1",path:"/images/gallery/lokal-kok-1.webp"},{filename:"lokal-kok-2.webp",category:"undervaning",subcategory:"kok",number:2,displayName:"Ladan - Kök 2",path:"/images/gallery/lokal-kok-2.webp"},{filename:"lokal-kok-3.webp",category:"undervaning",subcategory:"kok",number:3,displayName:"Ladan - Kök 3",path:"/images/gallery/lokal-kok-3.webp"},{filename:"lokal-kok-4.webp",category:"undervaning",subcategory:"kok",number:4,displayName:"Ladan - Kök 4",path:"/images/gallery/lokal-kok-4.webp"},{filename:"lokal-service-1.webp",category:"undervaning",subcategory:"service",number:1,displayName:"Ladan - Serviceområde 1",path:"/images/gallery/lokal-service-1.webp"},{filename:"lokal-service-2.webp",category:"undervaning",subcategory:"service",number:2,displayName:"Ladan - Serviceområde 2",path:"/images/gallery/lokal-service-2.webp"},{filename:"lokal-service-3.webp",category:"undervaning",subcategory:"service",number:3,displayName:"Ladan - Serviceområde 3",path:"/images/gallery/lokal-service-3.webp"}]},{id:"overvaning",name:"Loftet",description:"Övre våningen på Storegården 7",images:[{filename:"lokal-upper-1.webp",category:"overvaning",subcategory:"upper",number:1,displayName:"Loftet - Övre våning 1",path:"/images/gallery/lokal-upper-1.webp"},{filename:"lokal-upper-2.webp",category:"overvaning",subcategory:"upper",number:2,displayName:"Loftet - Övre våning 2",path:"/images/gallery/lokal-upper-2.webp"},{filename:"lokal-upper-3.webp",category:"overvaning",subcategory:"upper",number:3,displayName:"Loftet - Övre våning 3",path:"/images/gallery/lokal-upper-3.webp"},{filename:"lokal-upper-4.webp",category:"overvaning",subcategory:"upper",number:4,displayName:"Loftet - Övre våning 4",path:"/images/gallery/lokal-upper-4.webp"},{filename:"lokal-upper-5.webp",category:"overvaning",subcategory:"upper",number:5,displayName:"Loftet - Övre våning 5",path:"/images/gallery/lokal-upper-5.webp"}]},{id:"ute",name:"Övrigt",description:"Utemiljö och toaletter",images:[{filename:"lokal-ute-1.webp",category:"ute",subcategory:"ute",number:1,displayName:"Övrigt - Utemiljö 1",path:"/images/gallery/lokal-ute-1.webp"},{filename:"lokal-ute-toa-1.webp",category:"ute",subcategory:"ute-toa",number:1,displayName:"Övrigt - Toaletter 1",path:"/images/gallery/lokal-ute-toa-1.webp"},{filename:"lokal-ute-toa-2.webp",category:"ute",subcategory:"ute-toa",number:2,displayName:"Övrigt - Toaletter 2",path:"/images/gallery/lokal-ute-toa-2.webp"}]}],z={categories:se},ue=["lokal-upper-1.webp","lokal-upper-5.webp","lokal-under-1.webp","lokal-under-10.webp","lokal-under-11.webp","lokal-service-3.webp","lokal-ute-1.webp"],T={featured:ue};function ce(n,a){if(n==null)return{};var e=de(n,a),t,l;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(l=0;l<o.length;l++)t=o[l],!(a.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(e[t]=n[t])}return e}function de(n,a){if(n==null)return{};var e={},t=Object.keys(n),l,o;for(o=0;o<t.length;o++)l=t[o],!(a.indexOf(l)>=0)&&(e[l]=n[l]);return e}function $(){return $=Object.assign||function(n){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}return n},$.apply(this,arguments)}function Y(n,a){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);a&&(t=t.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),e.push.apply(e,t)}return e}function q(n){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?Y(Object(e),!0).forEach(function(t){ge(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Y(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function ge(n,a,e){return a in n?Object.defineProperty(n,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[a]=e,n}const me={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},H=2;class D extends B.Component{constructor(a){super(a),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||H,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const a=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||H});let t=1/0,l=e.default||H;for(let o in e){const s=parseInt(o);s>0&&a<=s&&s<t&&(t=s,l=e[o])}l=Math.max(1,parseInt(l)||1),this.state.columnCount!==l&&this.setState({columnCount:l})}itemsInColumns(){const a=this.state.columnCount,e=new Array(a),t=B.Children.toArray(this.props.children);for(let l=0;l<t.length;l++){const o=l%a;e[o]||(e[o]=[]),e[o].push(t[l])}return e}renderColumns(){const{column:a,columnAttrs:e={},columnClassName:t}=this.props,l=this.itemsInColumns(),o=`${100/l.length}%`;let s=t;s&&typeof s!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof s=="undefined"&&(s="my-masonry-grid_column"));const d=q(q(q({},a),e),{},{style:q(q({},e.style),{},{width:o}),className:s});return l.map((g,p)=>B.createElement("div",$({},d,{key:p}),g))}logDeprecated(a){console.error("[Masonry]",a)}render(){const a=this.props,{children:e,breakpointCols:t,columnClassName:l,columnAttrs:o,column:s,className:d}=a,g=ce(a,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let p=d;return typeof d!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof d=="undefined"&&(p="my-masonry-grid")),B.createElement("div",$({},g,{className:p}),this.renderColumns())}}D.defaultProps=me;const V={default:3,768:2};function _({images:n,isLoading:a,onImageSelect:e,categoryName:t}){return a?i.jsx(D,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:[...Array(6)].map((l,o)=>i.jsx("div",{className:"gallery-thumbnail skeleton-item",children:i.jsx("div",{className:"skeleton-image",style:{height:`${200+o%3*50}px`}})},o))}):i.jsx(D,{breakpointCols:V,className:"gallery-grid",columnClassName:"gallery-column",children:n.slice(0,6).map((l,o)=>i.jsx("div",{className:"gallery-thumbnail",onClick:()=>e(o),role:"button",tabIndex:0,"aria-label":`Öppna bild ${o+1} av ${n.length} i lightbox`,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),e(o))},children:i.jsx("img",{src:l.thumbnail,alt:l.thumbnailAlt,loading:"eager"})},o))})}_.propTypes={images:r.arrayOf(r.shape({thumbnail:r.string,thumbnailAlt:r.string})).isRequired,isLoading:r.bool.isRequired,onImageSelect:r.func.isRequired,categoryName:r.string};_.defaultProps={categoryName:"Alla"};const pe={default:3,768:2};function M({images:n,startIndex:a,totalCount:e,onImageSelect:t,categoryName:l,buttonMode:o,onToggle:s,containerRef:d,buttonRef:g}){return i.jsxs("div",{className:"expanded-gallery-container",ref:d,children:[i.jsx("div",{className:"gallery-sentinel sentinel-top","aria-hidden":"true"}),i.jsx(D,{breakpointCols:pe,className:"gallery-grid expanded-grid",columnClassName:"gallery-column",id:"expanded-gallery",children:n.map((p,c)=>{const f=c+a;return i.jsx("div",{className:"gallery-thumbnail",onClick:()=>t(f),role:"button",tabIndex:0,"aria-label":`Öppna bild ${f+1} av ${e} i lightbox`,onKeyDown:k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),t(f))},children:i.jsx("img",{src:p.thumbnail,alt:p.thumbnailAlt,loading:"lazy"})},f)})}),i.jsx("div",{className:"gallery-sentinel sentinel-bottom","aria-hidden":"true"}),i.jsx("button",{ref:g,className:`hide-images-button ${o==="fixed"?"is-fixed":""} ${o==="bottom"?"at-bottom":""} ${o==="hidden"?"is-hidden":""}`,onClick:s,"aria-label":"Dölj utökade galleri bilder","aria-hidden":o==="hidden",children:"Dölj bilder"})]})}M.propTypes={images:r.arrayOf(r.shape({thumbnail:r.string,thumbnailAlt:r.string})).isRequired,startIndex:r.number,totalCount:r.number,onImageSelect:r.func.isRequired,categoryName:r.string,buttonMode:r.string.isRequired,onToggle:r.func.isRequired,containerRef:r.shape({current:r.any}),buttonRef:r.shape({current:r.any})};M.defaultProps={startIndex:6,totalCount:0,categoryName:"Alla",containerRef:{current:null},buttonRef:{current:null}};function F({isOpen:n,images:a,currentIndex:e,currentImage:t,onClose:l,onNext:o,onPrevious:s,onSelectImage:d,dialogRef:g,closeButtonRef:p}){return n?i.jsx("div",{className:"gallery-model",role:"dialog","aria-modal":"true","aria-labelledby":"gallery-heading","aria-describedby":"gallery-description",ref:g,onMouseDown:c=>{c.target===c.currentTarget&&l()},children:i.jsxs("div",{className:"gallery-model-content",children:[i.jsxs("div",{id:"gallery-description",className:"sr-only",children:["Bildgalleri med ",a.length," bilder. Använd pilknapparna för att navigera, ESC för att stänga."]}),i.jsx("button",{className:"gallery-close-button",onClick:l,"aria-label":"Stäng bildgalleri",title:"Stäng lightbox (ESC)",ref:p,type:"button",children:"×"}),t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"lightbox-stage",children:[a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--prev",onClick:s,"aria-label":"Visa föregående bild",children:"‹"}),i.jsx("figure",{className:"lightbox-image-wrapper",children:i.jsx("img",{src:t.original,alt:t.originalAlt||t.description||"Bild i galleriet",loading:"eager"})}),a.length>1&&i.jsx("button",{type:"button",className:"lightbox-nav lightbox-nav--next",onClick:o,"aria-label":"Visa nästa bild",children:"›"})]}),i.jsxs("div",{className:"lightbox-footer",children:[i.jsxs("span",{className:"lightbox-counter","aria-live":"polite",children:[e+1," / ",a.length]}),a.length>1&&i.jsx("div",{className:"lightbox-thumbnails",role:"list",children:a.map((c,f)=>{var w;const k=f===e;return i.jsx("button",{type:"button",className:`lightbox-thumbnail ${k?"is-active":""}`,onClick:()=>d(f),"aria-label":`Gå till bild ${f+1} av ${a.length}`,"aria-current":k?"true":void 0,children:i.jsx("img",{src:c.thumbnail,alt:c.thumbnailAlt,loading:"lazy"})},(w=c.filename)!=null?w:f)})})]})]}):i.jsx("div",{className:"lightbox-empty",children:i.jsx("p",{children:"Inga bilder tillgängliga i denna kategori."})})]})}):null}F.propTypes={isOpen:r.bool.isRequired,images:r.arrayOf(r.shape({original:r.string,originalAlt:r.string,description:r.string,thumbnail:r.string,thumbnailAlt:r.string,filename:r.string})).isRequired,currentIndex:r.number.isRequired,currentImage:r.shape({original:r.string,originalAlt:r.string,description:r.string}),onClose:r.func.isRequired,onNext:r.func.isRequired,onPrevious:r.func.isRequired,onSelectImage:r.func.isRequired,dialogRef:r.shape({current:r.any}).isRequired,closeButtonRef:r.shape({current:r.any}).isRequired};F.defaultProps={currentImage:null};const be={default:3,768:2};function ee({images:n,onImageSelect:a}){return!n||n.length===0?null:i.jsxs("div",{className:"featured-gallery",children:[i.jsx(D,{breakpointCols:be,className:"gallery-grid",columnClassName:"gallery-column",children:n.map((e,t)=>{var l;return i.jsx("div",{className:"gallery-thumbnail",onClick:()=>a(t),role:"button",tabIndex:0,"aria-label":`Öppna utvald bild ${t+1} av ${n.length} i lightbox`,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),a(t))},children:i.jsx("img",{src:e.thumbnail,alt:e.thumbnailAlt,loading:"eager"})},(l=e.filename)!=null?l:t)})}),i.jsx("div",{className:"featured-divider","aria-hidden":"true"})]})}ee.propTypes={images:r.arrayOf(r.shape({thumbnail:r.string,thumbnailAlt:r.string,description:r.string,filename:r.string})).isRequired,onImageSelect:r.func.isRequired};const fe=["a[href]","area[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),W=(n,a)=>{if(a===0)return 0;const e=n%a;return e<0?e+a:e};function X(n,a){const[e,t]=u.useState(!1),[l,o]=u.useState(0),s=u.useRef(null),d=u.useRef(null),g=u.useRef(null),p=u.useRef(new Set),c=n.length>0,f=u.useCallback(m=>{c&&(g.current=document.activeElement,o(W(m,n.length)),t(!0))},[c,n.length]),k=u.useCallback(()=>{t(!1)},[]),w=u.useCallback(m=>{c&&o(W(m,n.length))},[c,n.length]),j=u.useCallback(()=>{c&&o(m=>(m+1)%n.length)},[c,n.length]),L=u.useCallback(()=>{c&&o(m=>(m-1+n.length)%n.length)},[c,n.length]);u.useEffect(()=>{if(!c){o(0);return}o(m=>m>=n.length?n.length-1:m<0?0:m)},[c,n.length]),u.useEffect(()=>{if(!e){document.body.classList.remove("lightbox-open");return}return document.body.classList.add("lightbox-open"),()=>{document.body.classList.remove("lightbox-open")}},[e]),u.useEffect(()=>{if(e){const b=d.current;b&&b.focus({preventScroll:!0});return}const m=g.current;m&&typeof m.focus=="function"&&requestAnimationFrame(()=>{m.focus({preventScroll:!0}),g.current=null})},[e]),u.useEffect(()=>{if(!e)return;const m=b=>{b.key==="Escape"&&k()};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,k]),u.useEffect(()=>{if(!e||!c)return;const m=b=>{switch(b.key){case"ArrowRight":b.preventDefault(),j();break;case"ArrowLeft":b.preventDefault(),L();break;case"Home":b.preventDefault(),w(0);break;case"End":b.preventDefault(),w(n.length-1);break}};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[e,c,n.length,j,L,w]),u.useEffect(()=>{if(!e)return;const m=s.current;if(!m)return;const b=N=>{if(N.key!=="Tab")return;const y=Array.from(m.querySelectorAll(fe)).filter(S=>!S.hasAttribute("aria-hidden"));if(y.length===0){N.preventDefault();return}const h=y[0],x=y[y.length-1],I=N.shiftKey,E=document.activeElement;!I&&E===x?(N.preventDefault(),h.focus()):I&&E===h&&(N.preventDefault(),x.focus())};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[e]);const R=u.useCallback(m=>{if(!c)return;const b=W(m,n.length),N=n[b];if(!(N!=null&&N.original)||p.current.has(N.original))return;const y=new Image;y.src=N.original,p.current.add(N.original)},[c,n]);u.useEffect(()=>{p.current.clear()},[a]),u.useEffect(()=>{!e||!c||(R(l),R(l+1),R(l-1))},[e,c,l,R]);const C=u.useMemo(()=>c?n[l]:null,[c,n,l]);return{isOpen:e,currentIndex:l,currentImage:C,openLightbox:f,closeLightbox:k,goToImage:w,goToNextImage:j,goToPreviousImage:L,dialogRef:s,closeButtonRef:d}}const A="hidden",J="fixed",Q="bottom";function ye(n){const[a,e]=u.useState(A),t=u.useRef(null),l=u.useRef(null),o=u.useRef(A),s=u.useCallback(d=>{o.current!==d&&(o.current=d,e(d))},[]);return u.useEffect(()=>{if(!n){s(A);return}const d=t.current;if(!d)return;let g=!1;const p=8,c=d.querySelector(".sentinel-top"),f=d.querySelector(".sentinel-bottom");let k=!1,w=!1,j,L;const R=y=>{let h=0,x=y;for(;x;)h+=x.offsetTop||0,x=x.offsetParent;return h},C=()=>{const y=t.current;if(!y)return;const h=R(y),x=y.offsetHeight,I=h+x,E=window.scrollY||window.pageYOffset,S=window.innerHeight||document.documentElement.clientHeight,P=E+S;if(P<h){s(A);return}if(E>=I){s(A);return}if(P>=I-p){s(Q);return}s(J)},m=()=>{g||(g=!0,requestAnimationFrame(()=>{C(),g=!1}))},b=()=>{C()};return"IntersectionObserver"in window&&c&&f&&(L=new IntersectionObserver(y=>{if(y.forEach(h=>{h.target===c&&(k=h.isIntersecting),h.target===f&&(w=h.isIntersecting)}),!k&&!w){const h=R(d),x=h+d.offsetHeight,I=window.scrollY||window.pageYOffset;if(I+(window.innerHeight||document.documentElement.clientHeight)<h||I>=x){s(A);return}}w?s(Q):k&&s(J)},{root:null,threshold:0}),L.observe(c),L.observe(f)),window.ResizeObserver&&(j=new ResizeObserver(()=>C()),j.observe(d)),d.querySelectorAll("img").forEach(y=>{y.complete||y.addEventListener("load",C,{once:!0})}),setTimeout(C,50),setTimeout(C,200),setTimeout(C,600),C(),window.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",b),()=>{window.removeEventListener("scroll",m),window.removeEventListener("resize",b),j&&j.disconnect(),L&&L.disconnect()}},[n,s]),{mode:a,containerRef:t,buttonRef:l}}function ve(){const[n,a]=u.useState("alla"),[e,t]=u.useState(!1),[l,o]=u.useState(!1),s=u.useMemo(()=>z.categories.find(v=>v.id===n),[n]),d=u.useMemo(()=>s!=null&&s.images?s.images.map(v=>({original:v.path,thumbnail:v.path,description:v.displayName,originalAlt:v.displayName,thumbnailAlt:v.displayName,filename:v.filename,subcategory:v.subcategory})):[],[s]),g=u.useMemo(()=>{if(!(T!=null&&T.featured)||T.featured.length===0)return[];const v=z.categories.find(K=>K.id==="alla");return v?T.featured.map(K=>{const O=v.images.find(oe=>oe.filename===K);return O?{original:O.path,thumbnail:O.path,description:O.displayName,originalAlt:O.displayName,thumbnailAlt:O.displayName,filename:O.filename,subcategory:O.subcategory}:null}).filter(Boolean):[]},[]),{isOpen:p,currentIndex:c,currentImage:f,openLightbox:k,closeLightbox:w,goToImage:j,goToNextImage:L,goToPreviousImage:R,dialogRef:C,closeButtonRef:m}=X(g,"featured"),{isOpen:b,currentIndex:N,currentImage:y,openLightbox:h,closeLightbox:x,goToImage:I,goToNextImage:E,goToPreviousImage:S,dialogRef:P,closeButtonRef:ne}=X(d,n),{mode:ae,containerRef:te,buttonRef:re}=ye(l),G=u.useCallback(()=>{o(v=>!v)},[]),le=u.useCallback(v=>{t(!0),a(v),o(!1),x(),setTimeout(()=>{t(!1)},300)},[x]),U=(s==null?void 0:s.name)||"Alla";return i.jsxs("div",{className:"storegarden-gallery",children:[i.jsx("div",{className:"gallery-logo-container",children:i.jsx("img",{src:ie,alt:"Storegården 7",className:"gallery-logo"})}),i.jsx("h2",{id:"gallery-heading",children:"Bildgalleri"}),g.length>0&&i.jsx(ee,{images:g,onImageSelect:k}),i.jsx(Z,{categories:z.categories,activeCategory:n,onCategoryChange:le}),i.jsx(_,{images:d,isLoading:e,onImageSelect:h,categoryName:U}),!l&&i.jsxs("button",{className:"show-more-button",onClick:G,"aria-expanded":l,"aria-controls":"expanded-gallery","aria-label":`Visa alla ${d.length} bilder i galleriet`,children:["Visa alla bilder (",d.length,")"]}),l&&i.jsx(M,{images:d.slice(6),startIndex:6,totalCount:d.length,onImageSelect:h,categoryName:U,buttonMode:ae,onToggle:G,containerRef:te,buttonRef:re}),i.jsx(F,{isOpen:p,images:g,currentIndex:c,currentImage:f,onClose:w,onNext:L,onPrevious:R,onSelectImage:j,dialogRef:C,closeButtonRef:m}),i.jsx(F,{isOpen:b,images:d,currentIndex:N,currentImage:y,onClose:x,onNext:E,onPrevious:S,onSelectImage:I,dialogRef:P,closeButtonRef:ne})]})}export{ve as default};
